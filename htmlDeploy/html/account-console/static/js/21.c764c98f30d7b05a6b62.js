webpackJsonp([21],{LxSE:function(t,e){},MGyb:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=o("L+8a"),l=o("ryJa"),r=o.n(l),i={data:function(){return{pagination:{page:1,sizes:20,total:0,corId:9},checkAll1:!1,checkedCities1:[],formList1:[],formList2:[],isIndeterminate1:!0,curworkflowId:"",addWorkflowForm:{workflowName:"",workflowRemark:""},updateWorkflowForm:{workfloId:"",workflowName:"",workflowRemark:""},workflowAddForm:{mentIds:[],workflowId:0},visible:{addWorkflow:!1,updateWorkflow:!1,relationMenu:!1,addMenu:!1},table:{search:{keyword:""},dataList:[]}}},mounted:function(){this.getWorkflowLists(),this.getAllforms()},methods:{dateFormat:function(t,e){var o=t[e.property];return void 0===o?"":r()(o).format("YYYY-MM-DD HH:ss:mm")},dateFrm:function(t){return r()(t).format("YYYY-MM-DD HH:ss:mm")},getWorkflowLists:function(){var t=this;Object(a.S)({page:this.pagination.page,size:this.pagination.sizes,keyword:this.table.search.keyword}).then(function(e){e.data.code===t.$global.successCode&&(t.table.dataList=e.data.data.list,t.pagination.total=e.data.data.total)},function(t){console.log("请求数据失败",t)})},handleCurrentChange:function(t){this.pagination.page=t,this.getWorkflowLists()},handleSizeChange:function(t){this.pagination.sizes=t,this.getWorkflowLists()},changeState1:function(t){var e=this;this.$confirm("是否确定禁用该工作流","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"info"}).then(function(){Object(a._4)({state:1,workflowId:t}).then(function(t){t.data.code===e.$global.successCode&&(e.$message({message:"禁用工作流成功！",type:"success"}),e.getWorkflowLists())},function(t){console.log("禁用工作流失败",t)})}).catch(function(){})},changeState2:function(t,e){var o=this;this.$confirm("是否确定启用该工作流","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"info"}).then(function(){Object(a._4)({state:0,workflowId:t}).then(function(t){t.data.code===o.$global.successCode&&(o.$message({message:"启用工作流成功！",type:"success"}),o.getWorkflowLists())},function(t){console.log("启用工作流失败",t)})}).catch(function(){})},deleteWorkflows:function(t){var e=this;this.$confirm("是否确定删除该工作流，工作流删除后不可恢复，请谨慎操作！","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"info"}).then(function(){Object(a.p)({id:t}).then(function(t){t.data.code===e.$global.successCode&&(e.$message({message:"删除工作流成功！",type:"success"}),e.getWorkflowLists())},function(t){console.log("删除工作流失败",t)})}).catch(function(){})},addWorkflowSubmit:function(){var t=this;this.$refs.addWorkflowForm.validate(function(e){if(!e)return!1;var o=t.addWorkflowForm;Object(a.i)(o).then(function(e){e.data.code===t.$global.successCode&&(t.$message({message:"添加工作流成功!",type:"success"}),t.getWorkflowLists(),t.visible.addWorkflow=!1)},function(t){console.log("添加工作流失败",t)})})},editWorkfolwbtn:function(t){this.visible.updateWorkflow=!0,this.updateWorkflowForm=t,this.curworkflowId=t.workflowId},editWorkflowSubmit:function(){var t=this;this.$refs.updateWorkflowForm.validate(function(e){if(!e)return!1;t.updateWorkflowForm.workfloId=t.curworkflowId;var o=t.updateWorkflowForm;Object(a._6)(o).then(function(e){e.data.code===t.$global.successCode&&(t.$message({message:"编辑工作流成功!",type:"success"}),t.visible.updateWorkflow=!1,t.getWorkflowLists())},function(t){console.log("编辑工作流失败",t)})})},getAllforms:function(){var t=this;this.formList1=[],Object(a.u)().then(function(e){e.data.code===t.$global.successCode&&(t.formList1=e.data.data)},function(t){console.log("请求数据失败",t)})},getFormLists:function(t){var e=this;Object(a.z)({workflow_id:t}).then(function(t){t.data.code===e.$global.successCode&&(e.formList2=t.data.data)},function(t){console.log("请求数据失败",t)})},openform:function(t){this.formList2=[],this.visible.relationMenu=!0,this.getFormLists(t),this.curworkflowId=t},deletement:function(t){var e=this;this.$confirm("是否确定删除该工作流表单？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"info"}).then(function(){Object(a.q)({mentId:t,workflowId:e.curworkflowId}).then(function(t){t.data.code===e.$global.successCode&&(e.$message({message:"删除工作表单流成功！",type:"success"}),e.getFormLists(e.curworkflowId),e.visible.relationMenu=!0)},function(t){console.log("删除工作流表单失败",t)})}).catch(function(){})},selectTableData:function(t){var e=this;this.workflowAddForm.mentIds=[],this.multipleSelection=t,this.multipleSelection.forEach(function(t){e.workflowAddForm.mentIds.push(t.mentId)})},addMenubtn:function(){this.visible.addMenu=!0},addMenuSubmit:function(){var t=this;this.workflowAddForm.workflowId=this.curworkflowId;var e=this.workflowAddForm;Object(a.h)(e).then(function(e){e.data.code===t.$global.successCode&&(t.$message({message:"添加工作流表单成功!",type:"success"}),t.visible.addMenu=!1,t.visible.relationMenu=!0,t.getFormLists(t.curworkflowId))},function(t){console.log("添加工作流表单失败",t)})}}},s={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"main"},[t._m(0),t._v(" "),o("div",{staticClass:"clear"}),t._v(" "),o("div",{staticClass:"application_item",staticStyle:{height:"calc(100vh - 130px)",padding:"0"}},[o("div",{staticClass:"common-setting-tab-content"},[o("div",{staticClass:"common-transverse-operation"},[o("el-button",{attrs:{type:"primary"},on:{click:function(e){t.visible.addWorkflow=!0}}},[t._v("添加工作流")]),t._v(" "),o("div",{staticClass:"search-input"},[o("el-input",{attrs:{placeholder:"搜索模块描述","suffix-icon":"el-icon-search"},on:{change:function(e){return t.getWorkflowLists()}},model:{value:t.table.search.keyword,callback:function(e){t.$set(t.table.search,"keyword",e)},expression:"table.search.keyword"}})],1)],1),t._v(" "),o("div",{staticClass:"common-table"},[o("el-table",{ref:"postsTable",attrs:{data:t.table.dataList,height:"100%"}},[o("el-table-column",{attrs:{type:"index",width:"60"}}),t._v(" "),o("el-table-column",{attrs:{prop:"workflowName",label:"工作流名称",width:"200"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("span",{staticStyle:{color:"#00aaee",cursor:"pointer"},on:{click:function(o){return t.editWorkfolwbtn(e.row)}}},[t._v(t._s(e.row.workflowName))])]}}])}),t._v(" "),o("el-table-column",{attrs:{prop:"createUserName",label:"创建人",width:"100"}}),t._v(" "),o("el-table-column",{attrs:{prop:"updateUserName",label:"更新人",width:"100"}}),t._v(" "),o("el-table-column",{attrs:{label:"创建时间",prop:"createTime",formatter:t.dateFormat}}),t._v(" "),o("el-table-column",{attrs:{label:"更新时间",prop:"updateTime",formatter:t.dateFormat}}),t._v(" "),o("el-table-column",{attrs:{label:"是否启用",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[0==e.row.visible?o("i",{staticClass:"el-icon-check",staticStyle:{color:"#29a339"}}):t._e(),t._v(" "),1==e.row.visible?o("i",{staticClass:"el-icon-close"}):t._e()]}}])}),t._v(" "),o("el-table-column",{attrs:{prop:"workflowRemark",label:"备注",width:"200"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("div",{staticClass:"overflowdiv",staticStyle:{width:"200px"},attrs:{title:e.row.workflowRemark}},[t._v("\n                  "+t._s(e.row.workflowRemark)+"\n                ")])]}}])}),t._v(" "),o("el-table-column"),t._v(" "),o("el-table-column",{attrs:{fixed:"right",label:"操作",width:"230"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("div",[o("el-button",{attrs:{type:"text"},on:{click:function(o){return t.openform(e.row.workflowId)}}},[t._v("关联")]),o("b",[t._v("|")]),t._v(" "),o("el-button",{attrs:{type:"text"}},[o("router-link",{attrs:{to:"/setting/workflow-design/"+e.row.workflowId}},[t._v("设计")])],1),o("b",[t._v("|")]),t._v(" "),0==e.row.visible?o("el-button",{attrs:{type:"text"},on:{click:function(o){return t.changeState1(e.row.workflowId)}}},[t._v("禁用")]):t._e(),t._v(" "),1==e.row.visible?o("el-button",{attrs:{type:"text"},on:{click:function(o){return t.changeState2(e.row.workflowId)}}},[t._v("启用")]):t._e(),o("b",[t._v("|")]),t._v(" "),o("el-button",{attrs:{type:"text"},on:{click:function(o){return t.deleteWorkflows(e.row.workflowId)}}},[t._v("删除")])],1)]}}])})],1)],1),t._v(" "),o("div",{staticClass:"pagination"},[o("el-pagination",{attrs:{"page-sizes":[10,20,50,100],"page-size":t.pagination.sizes,layout:"total, sizes, prev, pager, next, jumper",total:t.pagination.total,"current-page":t.pagination.page},on:{"current-change":t.handleCurrentChange,"size-change":t.handleSizeChange}})],1)]),t._v(" "),o("el-dialog",{attrs:{title:"新增工作流",visible:t.visible.addWorkflow,width:"600px"},on:{"update:visible":function(e){return t.$set(t.visible,"addWorkflow",e)}}},[o("el-form",{ref:"addWorkflowForm",staticClass:"demo-ruleForm",attrs:{model:t.addWorkflowForm,"label-width":"110px"}},[o("el-form-item",{attrs:{label:"工作流名称：",prop:"workflowName",rules:[{required:!0,message:"新工作流名称为空",trigger:"blur"}]}},[o("el-input",{attrs:{placeholder:"请输入新工作流名称"},model:{value:t.addWorkflowForm.workflowName,callback:function(e){t.$set(t.addWorkflowForm,"workflowName",e)},expression:"addWorkflowForm.workflowName"}})],1),t._v(" "),o("el-form-item",{attrs:{label:"备注：",prop:"workflowRemark",rules:[{required:!0,message:"备注为空",trigger:"blur"}]}},[o("el-input",{attrs:{type:"textarea",placeholder:"请输入备注"},model:{value:t.addWorkflowForm.workflowRemark,callback:function(e){t.$set(t.addWorkflowForm,"workflowRemark",e)},expression:"addWorkflowForm.workflowRemark"}})],1)],1),t._v(" "),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{attrs:{type:"primary"},on:{click:t.addWorkflowSubmit}},[t._v("确 定")]),t._v(" "),o("el-button",{on:{click:function(e){t.visible.addWorkflow=!1}}},[t._v("取 消")])],1)],1),t._v(" "),o("el-dialog",{attrs:{title:"修改工作流",visible:t.visible.updateWorkflow,width:"600px"},on:{"update:visible":function(e){return t.$set(t.visible,"updateWorkflow",e)}}},[o("el-form",{ref:"updateWorkflowForm",staticClass:"demo-ruleForm",attrs:{model:t.updateWorkflowForm,"label-width":"110px"}},[o("el-form-item",{attrs:{label:"工作流名称：",prop:"workflowName",rules:[{required:!0,message:"新工作流名称为空",trigger:"blur"}]}},[o("el-input",{attrs:{placeholder:"请输入工作流单名称"},model:{value:t.updateWorkflowForm.workflowName,callback:function(e){t.$set(t.updateWorkflowForm,"workflowName",e)},expression:"updateWorkflowForm.workflowName"}})],1),t._v(" "),o("el-form-item",{attrs:{label:"备注：",prop:"workflowRemark",rules:[{required:!0,message:"备注为空",trigger:"blur"}]}},[o("el-input",{attrs:{type:"textarea",placeholder:"请输入备注"},model:{value:t.updateWorkflowForm.workflowRemark,callback:function(e){t.$set(t.updateWorkflowForm,"workflowRemark",e)},expression:"updateWorkflowForm.workflowRemark"}})],1)],1),t._v(" "),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{attrs:{type:"primary"},on:{click:t.editWorkflowSubmit}},[t._v("确 定")]),t._v(" "),o("el-button",{on:{click:function(e){t.visible.updateWorkflow=!1}}},[t._v("取 消")])],1)],1),t._v(" "),o("el-dialog",{attrs:{title:"关联菜单",visible:t.visible.relationMenu,width:"600px"},on:{"update:visible":function(e){return t.$set(t.visible,"relationMenu",e)}}},[o("div",{staticStyle:{width:"100%","padding-bottom":"20px",position:"relative"}},[o("div",{staticStyle:{"margin-bottom":"15px"}},[o("el-button",{attrs:{type:"primary"},on:{click:t.addMenubtn}},[t._v("新增菜单")])],1),t._v(" "),o("div",[o("el-table",{staticStyle:{width:"100%","border-bottom":"none"},attrs:{data:t.formList2,height:"300"}},[o("el-table-column",{attrs:{prop:"mentName",label:"菜单",width:"130"}}),t._v(" "),o("el-table-column"),t._v(" "),o("el-table-column",{attrs:{width:"80",label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("el-button",{staticStyle:{cursor:"pointer"},attrs:{type:"text"},on:{click:function(o){return t.deletement(e.row.mentId)}}},[t._v("删除")])]}}])})],1)],1)])]),t._v(" "),o("el-dialog",{attrs:{title:"新增菜单",visible:t.visible.addMenu,width:"600px"},on:{"update:visible":function(e){return t.$set(t.visible,"addMenu",e)}}},[o("div",{staticStyle:{width:"100%","padding-bottom":"20px",position:"relative"}},[o("el-table",{staticStyle:{width:"100%","border-bottom":"none"},attrs:{data:t.formList1,height:"300"},on:{"selection-change":t.selectTableData}},[o("el-table-column",{attrs:{type:"selection",width:"60"}}),t._v(" "),o("el-table-column",{attrs:{prop:"mentName",label:"菜单",width:"130"}}),t._v(" "),o("el-table-column")],1)],1),t._v(" "),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{attrs:{type:"primary"},on:{click:t.addMenuSubmit}},[t._v("确 定")]),t._v(" "),o("el-button",{on:{click:function(e){t.visible.addMenu=!1}}},[t._v("取 消")])],1)])],1)])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"title_warp"},[e("h2",{staticClass:"title2"},[e("span",[this._v("系统设置")]),this._v(" > 工作流管理")])])}]};var n=o("C7Lr")(i,s,!1,function(t){o("LxSE")},"data-v-dcbe9ec8",null);e.default=n.exports}});