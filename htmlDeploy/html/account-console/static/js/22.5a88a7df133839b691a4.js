webpackJsonp([22],{"Ai/P":function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var i=e("GqZ+"),n=e("ryJa"),o=e.n(n),l={name:"ApplicationRenew",data:function(){return{applicationTime:0,applicationName:"",total1:0,total2:0,total3:0,total4:0,total5:0,total6:0,total7:0,curtab:0,currentPage:4,tableApplications:[{openbtnvisible:2,appId:1,appName:"",appMark:"",appContent:"",appLogo:"",state:0,licenseBeginTime:0,licenseEndTime:0,remainingDays:"",money:0,discount:[{month:0,discount:0}]}],multipleSelection:[],filterTableData:[],totalTableData:[],NewTableData:[],allTableData:[],paginations:{page_index:1,total:0,page_size:10,page_sizes:[10,15,20],layout:"total, sizes, prev, pager, next, jumper"}}},created:function(){},mounted:function(){this.getApplication()},methods:{dateFrm:function(t){return o()(t).format("YYYY-MM-DD")},dateFormat:function(t,a){var e=t[a.property];return void 0===e?"":o()(e).format("YYYY-MM-DD")},getApplication:function(){var t=this;Object(i.g)().then(function(a){a.data.code===t.$global.successCode&&(t.allTableData=a.data.data,t.filterTableData=a.data.data,t.totalTableData=a.data.data,t.NewTableData=a.data.data,t.setPaginations(),t.onScreeoutTotal(),t.onScreeoutNew())},function(t){console.log("请求应用数据失败",t)})},handleSelectionChange:function(t){this.multipleSelection=t},handleCurrentChange:function(t){var a=this,e=this.paginations.page_size*(t-1),i=this.allTableData.filter(function(t,a){return a>=e});this.tableApplications=i.filter(function(t,e){return e<a.paginations.page_size})},handleSizeChange:function(t){this.paginations.page_index=1,this.paginations.page_size=t,this.tableApplications=this.allTableData.filter(function(a,e){return e<t})},setPaginations:function(){var t=this;this.paginations.total=this.allTableData.length,this.paginations.page_index=1,this.paginations.page_size=10,this.tableApplications=this.allTableData.filter(function(a,e){return e<t.paginations.page_size})},onScreeoutTime:function(t,a){this.curtab=t;var e=Number(a);6e7==e?this.getApplication():this.allTableData=this.filterTableData.filter(function(t){var a=t.remainingDays.replace(/[+天]/g,""),i=Number(a);return isNaN(e)?isNaN(i):i<e}),this.setPaginations()},onScreeoutTotal:function(){var t=this,a=1,e=1,i=1,n=1,o=1,l=1,c=1,s=1e7;this.totalTableData.forEach(function(r){t.total1=a++;var p=r.remainingDays.replace(/[+天]/g,""),u=Number(p);return isNaN(u)?t.total7=c++:u<=7?t.total2=e++:u<=15?t.total3=i++:u<=30?t.total4=n++:u<=60?t.total5=o++:u<=90?t.total6=l++:s>p?s=p:void 0})},onScreeoutNew:function(){var t=this,a=1e7;this.NewTableData.forEach(function(e){var i=e.remainingDays.replace(/[+天]/g,""),n=Number(i);a>n&&(a=n,t.applicationName=e.appName,t.applicationTime=e.licenseEndTime)})},openApplication:function(t){var a=this;this.$confirm("是否确定开启该应用","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var e={appId:t,state:0};Object(i.d)(e).then(function(t){t.data.code===a.$global.successCode&&a.getApplication()},function(t){console.log("请求应用数据失败",t)})}).catch(function(){})},closeApplication:function(t){var a=this;this.$confirm("是否确定关闭该应用","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var e={appId:t,state:1};Object(i.d)(e).then(function(t){t.data.code===a.$global.successCode&&a.getApplication()},function(t){console.log("请求应用数据失败",t)})}).catch(function(){})},changeMask:function(t){}}},c={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"main",staticStyle:{height:"calc(100vh - 168px)"}},[t._m(0),t._v(" "),e("div",{staticClass:"clear"}),t._v(" "),e("div",{staticClass:"application_item",staticStyle:{height:"calc(100vh - 298px)"}},[e("h2",{staticClass:"application_alert"},[t._v("温馨提示：您的 "+t._s(t.applicationName)+" 账户即将于  "+t._s(t.dateFrm(t.applicationTime))+"  到期")]),t._v(" "),e("div",{staticClass:"application_data"},[e("el-form",{staticClass:"demo-ruleForm",attrs:{"status-icon":"","label-width":"100px"}},[e("el-form-item",{attrs:{label:"时间范围："}},[e("ul",{staticClass:"buytime"},[e("li",{class:{active:0==t.curtab},on:{click:function(a){return t.onScreeoutTime(0,6e7)}}},[e("div",[t._v("全部 "),e("span",[t._v(t._s(t.total1))])])]),t._v(" "),e("li",{class:{active:1==t.curtab},on:{click:function(a){return t.onScreeoutTime(1,7)}}},[e("div",[t._v("7天内到期 "),e("span",[t._v(t._s(t.total2))])])]),t._v(" "),e("li",{class:{active:2==t.curtab},on:{click:function(a){return t.onScreeoutTime(2,15)}}},[e("div",[t._v("15天内到期 "),e("span",[t._v(t._s(t.total3))])])]),t._v(" "),e("li",{class:{active:3==t.curtab},on:{click:function(a){return t.onScreeoutTime(3,30)}}},[e("div",[t._v("30天内到期 "),e("span",[t._v(t._s(t.total4))])])]),t._v(" "),e("li",{class:{active:4==t.curtab},on:{click:function(a){return t.onScreeoutTime(4,60)}}},[e("div",[t._v("2个月内到期 "),e("span",[t._v(t._s(t.total5))])])]),t._v(" "),e("li",{class:{active:5==t.curtab},on:{click:function(a){return t.onScreeoutTime(5,90)}}},[e("div",[t._v("3个月内到期 "),e("span",[t._v(t._s(t.total6))])])]),t._v(" "),e("li",{class:{active:6==t.curtab},on:{click:function(a){return t.onScreeoutTime(6,"已过期")}}},[e("div",[t._v("已到期 "),e("span",[t._v(t._s(t.total7))])])])])])],1)],1),t._v(" "),e("div",{staticClass:"application_table"},[e("el-table",{ref:"multipleTable",staticStyle:{width:"100%",height:"calc(100vh - 390px)",overflow:"auto"},attrs:{stripe:"",data:t.tableApplications,"tooltip-effect":"dark"},on:{"selection-change":t.handleSelectionChange}},[e("el-table-column",{attrs:{type:"selection",width:"55"}}),t._v(" "),e("el-table-column",{attrs:{prop:"appName",label:"应用名称",width:"180"}}),t._v(" "),e("el-table-column",{attrs:{prop:"licenseBeginTime",formatter:t.dateFormat,label:"许可开始时间",width:"130"}}),t._v(" "),e("el-table-column",{attrs:{prop:"licenseEndTime",formatter:t.dateFormat,label:"许可到期时间",width:"130"}}),t._v(" "),e("el-table-column",{attrs:{prop:"remainingDays",label:"剩余时间",width:"130"}}),t._v(" "),e("el-table-column",{attrs:{label:"状态",width:"100"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("i",{directives:[{name:"show",rawName:"v-show",value:1==a.row.state,expression:"scope.row.state == 1"}],staticClass:"icon iconfont icon-kaiguanguan",staticStyle:{color:"#ccc","font-size":"20px"},on:{click:function(e){return t.openApplication(a.row.appId)}}}),t._v(" "),e("i",{directives:[{name:"show",rawName:"v-show",value:0==a.row.state,expression:"scope.row.state == 0"}],staticClass:"icon iconfont icon-kaiguanguan1",staticStyle:{color:"#04be02","font-size":"20px"},on:{click:function(e){return t.closeApplication(a.row.appId)}}})]}}])}),t._v(" "),e("el-table-column"),t._v(" "),e("el-table-column",{attrs:{label:"操作",width:"80"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-button",{attrs:{type:"text"}},[e("router-link",{attrs:{to:"/application/application-open/"+a.row.appId}},[t._v("续费")])],1)]}}])})],1)],1),t._v(" "),e("div",{staticClass:"pagination"},[t.paginations.total>0?e("el-pagination",{attrs:{"page-sizes":t.paginations.page_sizes,"page-size":t.paginations.page_size,layout:t.paginations.layout,total:t.paginations.total,"current-page":t.paginations.page_index},on:{"update:currentPage":function(a){return t.$set(t.paginations,"page_index",a)},"update:current-page":function(a){return t.$set(t.paginations,"page_index",a)},"current-change":t.handleCurrentChange,"size-change":t.handleSizeChange}}):t._e()],1)])])},staticRenderFns:[function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"title_warp"},[a("h2",{staticClass:"title2"},[a("span",[this._v("应用管理")]),this._v(" >应用续费列表")])])}]};var s=e("C7Lr")(l,c,!1,function(t){e("SOiS")},"data-v-dbaae0b4",null);a.default=s.exports},SOiS:function(t,a){}});