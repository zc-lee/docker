webpackJsonp([43],{"28cI":function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=s("L+8a"),o={data:function(){return{data2:[],value2:[],allTableData:[],allMemberData:[],tablePostList:[],pagination:{page:1,sizes:20,total:0,postId:1},paginationMember:{page:1,sizes:20,total:0,postId:1},postUser:{postId:"",userIdList:[]},postUser2:{postId:"",userId:""},syspost:{postName:"",postRemark:"",parentId:1,parentpostname:""},editpost:{parentId:1,postId:"",postName:"",postRemark:""},changepost:{parentId:1,postId:"",parentpostname1:""},postLists:[],postList:[],filterTableData:[],url:"",options:[],value8:"",visible:{addpost:!1,updatepost:!1,people:!1,addpeople:!1,changepost:!1},setTree:[],tree:{props:{id:"postId",label:"postName",children:"children"},click:{organizeId:"",organizeName:"",idPath:"",type:0},data:[]},postPeople:{search:{keyword:""},dataList:[]},table:{config:{loading:!1},search:{keyword:""},checkbox:{value:!1},dataList:[]},postCorId:0}},created:function(){this.getPostTrees(),this.getSysPost()},methods:{setTrees:function(){for(var t=this.setTree,e=[],s=0;s<t.length;s++)if("1"==t[s].postId){var a=t[s];a.label=t[s].postName,a.children=[],e.push(a),t.splice(s,1),s--}!function e(s){if(0!=t.length)for(var a=0;a<s.length;a++){for(var o=0;o<t.length;o++)if(t[o].parentId==s[a].postId){var i=t[o];i.label=t[o].postName,i.children=[],s[a].children.push(i),t.splice(o,1),o--}e(s[a].children)}}(e),this.tree.data=e},clickTreeData:function(t){this.syspost.parentpostname=t.postName,this.syspost.postRemark="",this.syspost.postName="",this.syspost.parentId=t.postId,this.pagination.postId=t.postId,this.paginationMember.postId=t.postId,this.getSysPost(t.postId)},getPostTrees:function(){var t=this;Object(a.J)().then(function(e){e.data.code===t.$global.successCode&&(t.setTree=e.data.data,t.setTrees())},function(t){console.log("请求数据失败",t)})},getSysPost:function(){var t=this;Object(a.I)({postid:this.pagination.postId,page:this.pagination.page,size:this.pagination.sizes,keyword:this.table.search.keyword}).then(function(e){e.data.code===t.$global.successCode&&(t.allTableData=e.data.data.list,t.pagination.total=e.data.data.total,t.filterTableData=e.data.data.list)},function(t){console.log("请求数据失败",t)})},handleCurrentChange:function(t){this.pagination.page=t,this.getSysPost()},handleSizeChange:function(t){this.pagination.sizes=t,this.getSysPost()},queryPostSearch:function(t,e){var s=this;Object(a.H)({query:t}).then(function(t){t.data.code===s.$global.successCode&&(s.postList=[],s.postLists=t.data.data,s.postList=s.postLists.map(function(t){return{value:t.label,postId:t.value}}),e(s.postList))},function(t){console.log("请求用户数据失败",t)})},createFilter:function(t){return function(e){return 0===e.value.toLowerCase().indexOf(t.toLowerCase())}},handlePostSelect:function(t){this.syspost.parentId=t.postId,this.syspost.parentpostname=t.value},handlePostSelect1:function(t){this.changepost.parentId=t.postId,this.changepost.parentpostname1=t.value},addPost:function(){this.visible.addpost=!0},addPostSubmit:function(){var t=this;this.$refs.syspost.validate(function(e){if(!e)return!1;var s=t.syspost.parentId,o=t.syspost;Object(a.e)(o).then(function(e){e.data.code===t.$global.successCode&&(t.$message({message:"添加岗位成功！",type:"success"}),t.getSysPost(s),t.getPostTrees(),t.visible.addpost=!1)},function(t){console.log("添加岗位失败",t)})})},updatePost:function(t){this.visible.updatepost=!0,this.editpost=t},updatePostSubmit:function(){var t=this;this.$refs.syspost2.validate(function(e){if(!e)return!1;var s=t.editpost;Object(a._3)(s).then(function(e){e.data.code===t.$global.successCode&&(t.$message({message:"编辑岗位成功！",type:"success"}),t.getSysPost(t.editpost.parentId),t.visible.updatepost=!1)},function(t){console.log("编辑岗位失败",t)})})},deletepost:function(t){var e=this;1!==t.postId?this.$confirm("是否确定删除该岗位 "+this.tree.click.organizeName,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(a.n)({postId:t.postId}).then(function(s){s.data.code===e.$global.successCode&&(e.$message({message:"删除岗位成功！",type:"success"}),e.getSysPost(t.parentId),e.getPostTrees())},function(t){console.log("删除岗位失败",t)})}).catch(function(){}):this.$message.error("根岗位不能删除")},changePeople:function(t){this.changepost.postId=t.postId,this.visible.changepost=!0},saveChangePost:function(){var t=this;this.$refs.changepost.validate(function(e){if(!e)return!1;var s=t.changepost;Object(a.W)(s).then(function(e){e.data.code===t.$global.successCode&&(t.$message({message:"移动岗位成功！",type:"success"}),t.getSysPost(t.changepost.parentId),t.getPostTrees(),t.visible.changepost=!1)},function(t){console.log("移动岗位失败",t)})})},addpeople:function(t){this.paginationMember.postId=t,this.postCorId=t,this.visible.people=!0,this.getSysPostPeople(t)},getSysPostPeople:function(){var t=this;Object(a.K)({postid:this.paginationMember.postId,page:this.paginationMember.page,size:this.paginationMember.sizes,keyword:""}).then(function(e){e.data.code===t.$global.successCode&&(t.allMemberData=e.data.data.list,t.paginationMember.total=e.data.data.total,t.postPeople.dataList=t.allMemberData)},function(t){console.log("请求数据失败",t)})},handleCurrentChangeMember:function(t){this.paginationMember.page=t,this.getSysPostPeople()},handleSizeChangeMember:function(t){this.paginationMember.sizes=t,this.getSysPostPeople()},addPostPeople:function(){var t=this.postCorId;this.visible.addpeople=!0,this.getNotInPeopleLists(t)},getNotInPeopleLists:function(t){var e=this;Object(a.E)({postid:t}).then(function(t){t.data.code===e.$global.successCode&&(e.data2=[],e.value2=[],t.data.data.forEach(function(t,s){e.data2.push({label:t.userName,key:t.userId})}))},function(t){console.log("请求数据失败",t)})},postAddPeople:function(){var t=this;if(this.value2.length<1)this.$message({showClose:!0,message:"请选择人员！",type:"error"});else{this.postUser.postId=this.postCorId,this.postUser.userIdList=this.value2;var e=this.postUser;Object(a.f)(e).then(function(e){e.data.code===t.$global.successCode&&(t.$message({message:"添加岗位用户成功！",type:"success"}),t.visible.addpeople=!1,t.visible.people=!0,t.getSysPostPeople(t.postCorId))},function(t){console.log("添加岗位用户失败",t)})}},deletePostPeople:function(t){var e=this;this.postUser2.postId=this.postCorId,this.postUser2.userId=t;var s=this.postUser2;this.$confirm("是否确定删除该岗位人员 "+this.tree.click.organizeName,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(a.o)(s).then(function(t){t.data.code===e.$global.successCode&&(e.$message({message:"删除岗位人员成功！",type:"success"}),e.visible.people=!0,e.getSysPostPeople(e.postCorId))},function(t){console.log("删除岗位人员失败",t)})}).catch(function(){})},selectTableData:function(t){},handlePeopleClick:function(){var t=this;""!==this.postPeople.search.keyword?this.allMemberData=this.allMemberData.filter(function(e){if(null!==e.userName&&-1!==e.userName.indexOf(t.postPeople.search.keyword))return!0}):this.allMemberData=this.postPeople.dataList}}},i={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"main"},[t._m(0),t._v(" "),s("div",{staticClass:"clear"}),t._v(" "),s("div",{staticClass:"application_item",staticStyle:{height:"calc(100vh - 130px)",padding:"0"}},[s("div",{staticClass:"common-setting-tab-content"},[s("el-row",[s("el-col",{staticClass:"common-tab-content-left",attrs:{span:6}},[s("el-tree",{attrs:{data:t.tree.data,props:t.tree.props,"highlight-current":!0,"node-key":"postId","default-expanded-keys":[1]},on:{"node-click":t.clickTreeData}})],1),t._v(" "),s("el-col",{staticClass:"common-tab-content-right",attrs:{span:18}},[s("div",{staticClass:"common-operation"},[s("el-button",{attrs:{type:"primary"},on:{click:t.addPost}},[t._v("添加岗位")]),t._v(" "),s("div",{staticClass:"search-input"},[s("el-input",{attrs:{placeholder:"搜索岗位名称","suffix-icon":"el-icon-search"},on:{change:t.getSysPost},model:{value:t.table.search.keyword,callback:function(e){t.$set(t.table.search,"keyword",e)},expression:"table.search.keyword"}})],1)],1),t._v(" "),s("div",{staticClass:"common-table"},[s("el-table",{ref:"organizeTable",attrs:{data:t.allTableData,height:"100%"},on:{"selection-change":t.selectTableData}},[s("el-table-column",{attrs:{type:"index",width:"60"}}),t._v(" "),s("el-table-column",{attrs:{label:"岗位名称",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("span",{staticClass:"click-col",on:{click:function(s){return t.updatePost(e.row)}}},[t._v(t._s(e.row.postName))])]}}])}),t._v(" "),s("el-table-column",{attrs:{prop:"postRemark",label:"岗位描述",width:"200"}}),t._v(" "),s("el-table-column"),t._v(" "),s("el-table-column",{attrs:{label:"操作",width:"170",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("div",[s("el-button",{attrs:{type:"text"},on:{click:function(s){return t.addpeople(e.row.postId)}}},[t._v("所含人员")]),t._v(" "),s("b",[t._v("|")]),t._v(" "),s("el-button",{attrs:{type:"text"},on:{click:function(s){return t.changePeople(e.row)}}},[t._v("移动")]),t._v(" "),s("b",[t._v("|")]),t._v(" "),s("el-button",{attrs:{type:"text"},on:{click:function(s){return t.deletepost(e.row)}}},[t._v("删除")])],1)]}}])})],1)],1),t._v(" "),s("div",{staticClass:"pagination"},[s("el-pagination",{attrs:{"page-sizes":[10,20,50,100],"page-size":t.pagination.sizes,layout:"total, sizes, prev, pager, next, jumper",total:t.pagination.total,"current-page":t.pagination.page},on:{"current-change":t.handleCurrentChange,"size-change":t.handleSizeChange}})],1)])],1),t._v(" "),s("el-dialog",{staticClass:"private-pop",attrs:{title:"增加岗位",visible:t.visible.addpost,width:"600px"},on:{"update:visible":function(e){return t.$set(t.visible,"addpost",e)}}},[s("el-form",{ref:"syspost",attrs:{model:t.syspost,"label-width":"90px"}},[s("el-form-item",{attrs:{label:"上级岗位",prop:"parentId",rules:[{required:!0,message:"请选择上级岗位",trigger:"blur"}]}},[s("el-autocomplete",{staticClass:"inline-input",attrs:{"fetch-suggestions":t.queryPostSearch,placeholder:"搜索上级岗位名称","trigger-on-focus":!0},on:{select:t.handlePostSelect},model:{value:t.syspost.parentpostname,callback:function(e){t.$set(t.syspost,"parentpostname",e)},expression:"syspost.parentpostname"}})],1),t._v(" "),s("el-form-item",{attrs:{label:"岗位名称",prop:"postName",rules:[{required:!0,message:"请输入岗位名称",trigger:"blur"}]}},[s("el-input",{attrs:{size:"medium",placeholder:"请输入岗位名称"},model:{value:t.syspost.postName,callback:function(e){t.$set(t.syspost,"postName",e)},expression:"syspost.postName"}})],1),t._v(" "),s("el-form-item",{attrs:{label:"岗位描述",prop:"postRemark",rules:[{required:!0,message:"请输入岗位描述",trigger:"blur"}]}},[s("el-input",{attrs:{type:"textarea",rows:2,placeholder:"请输入岗位描述"},model:{value:t.syspost.postRemark,callback:function(e){t.$set(t.syspost,"postRemark",e)},expression:"syspost.postRemark"}})],1)],1),t._v(" "),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{type:"primary",size:"medium"},on:{click:t.addPostSubmit}},[t._v("保存岗位")]),t._v(" "),s("el-button",{staticClass:"el-button--gry",attrs:{size:"medium"},on:{click:function(e){t.visible.addpost=!1}}},[t._v("取消")])],1)],1),t._v(" "),s("el-dialog",{staticClass:"private-pop",attrs:{title:"编辑岗位",visible:t.visible.updatepost,width:"600px"},on:{"update:visible":function(e){return t.$set(t.visible,"updatepost",e)}}},[s("el-form",{ref:"syspost2",attrs:{model:t.editpost,"label-width":"90px"}},[s("el-form-item",{attrs:{label:"岗位名称",prop:"postName",rules:[{required:!0,message:"请输入岗位名称",trigger:"blur"}]}},[s("el-input",{attrs:{size:"medium",placeholder:"请输入岗位名称"},model:{value:t.editpost.postName,callback:function(e){t.$set(t.editpost,"postName",e)},expression:"editpost.postName"}})],1),t._v(" "),s("el-form-item",{attrs:{label:"岗位描述",prop:"postRemark"}},[s("el-input",{attrs:{type:"textarea",rows:2,placeholder:"请输入岗位描述"},model:{value:t.editpost.postRemark,callback:function(e){t.$set(t.editpost,"postRemark",e)},expression:"editpost.postRemark"}})],1)],1),t._v(" "),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{type:"primary",size:"medium"},on:{click:t.updatePostSubmit}},[t._v("保存岗位")]),t._v(" "),s("el-button",{staticClass:"el-button--gry",attrs:{size:"medium"},on:{click:function(e){t.visible.updatepost=!1}}},[t._v("取消")])],1)],1),t._v(" "),s("el-dialog",{staticClass:"private-pop",attrs:{title:"添加用户",visible:t.visible.addpeople,width:"600px"},on:{"update:visible":function(e){return t.$set(t.visible,"addpeople",e)}}},[s("div",{staticClass:"feedback-content",staticStyle:{"padding-bottom":"20px"}},[s("el-transfer",{attrs:{titles:["未选中人员","选中人员"],data:t.data2},model:{value:t.value2,callback:function(e){t.value2=e},expression:"value2"}})],1),t._v(" "),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{type:"primary",size:"medium"},on:{click:t.postAddPeople}},[t._v("确定")]),t._v(" "),s("el-button",{staticClass:"el-button--gry",attrs:{size:"medium"},on:{click:function(e){t.visible.addpeople=!1}}},[t._v("取消")])],1)]),t._v(" "),s("el-dialog",{staticClass:"private-pop",attrs:{title:"转移岗位",visible:t.visible.changepost,width:"600px"},on:{"update:visible":function(e){return t.$set(t.visible,"changepost",e)}}},[s("el-form",{ref:"changepost",attrs:{model:t.changepost,"label-width":"90px"}},[s("el-form-item",{attrs:{label:"上级岗位",prop:"parentId",rules:[{required:!0,message:"请选择上级岗位",trigger:"blur"}]}},[s("el-autocomplete",{staticClass:"inline-input",attrs:{"fetch-suggestions":t.queryPostSearch,placeholder:"搜索上级岗位名称","trigger-on-focus":!1},on:{select:t.handlePostSelect1},model:{value:t.changepost.parentpostname1,callback:function(e){t.$set(t.changepost,"parentpostname1",e)},expression:"changepost.parentpostname1"}})],1)],1),t._v(" "),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{type:"primary",size:"medium"},on:{click:t.saveChangePost}},[t._v("确定")]),t._v(" "),s("el-button",{staticClass:"el-button--gry",attrs:{size:"medium"},on:{click:function(e){t.visible.changepost=!1}}},[t._v("取消")])],1)],1),t._v(" "),s("el-dialog",{staticClass:"private-pop",attrs:{title:"包含人员",visible:t.visible.people,width:"600px"},on:{"update:visible":function(e){return t.$set(t.visible,"people",e)}}},[s("div",{staticStyle:{"margin-bottom":"50px"}},[s("el-input",{staticStyle:{float:"left",width:"300px"},attrs:{placeholder:"搜索人员名称","suffix-icon":"el-icon-search"},on:{change:t.handlePeopleClick},model:{value:t.postPeople.search.keyword,callback:function(e){t.$set(t.postPeople.search,"keyword",e)},expression:"postPeople.search.keyword"}}),t._v(" "),s("el-button",{staticStyle:{float:"right"},attrs:{type:"primary",size:"medium "},on:{click:t.addPostPeople}},[t._v("添加人员")])],1),t._v(" "),s("div",[s("el-table",{staticStyle:{width:"100%"},attrs:{data:t.allMemberData,height:"300"}},[s("el-table-column",{attrs:{prop:"userName",label:"姓名"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("div",[s("div",{staticStyle:{float:"left"}},[s("img",{staticStyle:{width:"30px",height:"30px","border-radius":"50%"},attrs:{src:e.row.headImage,alt:""}})]),t._v(" "),s("div",{staticStyle:{float:"left","margin-left":"5px","margin-top":"5px"}},[t._v(t._s(e.row.userName))])])]}}])}),t._v(" "),s("el-table-column",{attrs:{width:"140",label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("el-button",{attrs:{type:"text",size:"small"},on:{click:function(s){return t.deletePostPeople(e.row.userId)}}},[t._v("删除")])]}}])})],1)],1),t._v(" "),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("div",{staticClass:"pagination"},[s("el-pagination",{attrs:{"page-sizes":[10,20,50,100],"page-size":t.paginationMember.sizes,layout:"total, sizes, prev, pager, next, jumper",total:t.paginationMember.total,"current-page":t.paginationMember.page},on:{"current-change":t.handleCurrentChangeMember,"size-change":t.handleSizeChangeMember}})],1)])])],1)])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"title_warp"},[e("h2",{staticClass:"title2"},[e("span",[this._v("系统设置")]),this._v(" > 岗位管理")])])}]};var n=s("C7Lr")(o,i,!1,function(t){s("DlOk")},"data-v-40e4c9aa",null);e.default=n.exports},DlOk:function(t,e){}});