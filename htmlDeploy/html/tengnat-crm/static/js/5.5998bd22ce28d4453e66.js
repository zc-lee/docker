webpackJsonp([5],{KqL0:function(e,t){},"Pv/8":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("4YfN"),r=a.n(i),s=a("yqeo");function o(e){return Object(s.a)({url:"/order-service/service-collaboration",method:"POST",data:e})}var l=a("hFFN"),n=a("iz/j"),d=a("2bvH"),c=a("xzFr"),m=a("ryJa"),u=a.n(m),v=a("G+Zt"),p={props:["status"],data:function(){return{table:{loading:!1,dataList:[]},pageObject:{page:this.$global.pageParam.page,size:this.$global.pageParam.size,total:this.$global.pageParam.total},search:{keyword:""},userModal:{loading:!1,visible:!1,dataList:[],value:"",remark:"",serviceNo:"",collaboration:{loading:!1,visible:!1,dataList:[],value:"",serviceNo:""}}}},computed:r()({},Object(d.c)(["serviceOrderStatus","loginUserInfo"])),mounted:function(){console.log(this.status),this.status.name===this.$global.orderAllTab&&this.doSearch("")},methods:{showStart:function(e){return e===this.loginUserInfo.userId||"ORDER_WAIT_COMMIT"===this.status.name},listOrder:function(e){var t=this;this.table.loading=!0,function(e){return Object(s.a)({url:"/order-service/service-list",method:"GET",params:e})}(e).then(function(e){console.log(e.data.data);var a=e.data.data;t.pageObject.total=a.total,t.table.dataList=a.list,t.table.loading=!1}).catch(function(e){t.table.loading=!1})},doSearch:function(e){this.pageObject.page=1,this.search.keyword=e,this.listOrder(this.getRequestParams())},getRequestParams:function(){var e={page:this.pageObject.page,size:this.pageObject.size};return this.search.keyword&&(e.keyword=this.search.keyword),this.status.name!==this.$global.orderAllTab&&(e.status=this.status.name),e},handleChange:function(){this.listOrder(this.getRequestParams())},transOrderStatus:function(e){for(var t=0;t<this.serviceOrderStatus.length;t++){var a=this.serviceOrderStatus[t];if(a.key===e)return a.name}return"未知状态"},formatTimeStamp:function(e){return u()(e).format("YYYY-MM-DD HH:mm:ss")},formatMoney:function(e){return e.toFixed(2)},showOrderDetail:function(e){e.readonly=1,this.$emit("order-service-detail",e)},operation:function(e){return e.substring(1)},showOrderDetailBatch:function(e){e.readonly=2,this.$emit("order-service-detail",e)},getUserLists:function(e){var t=this;""!==e?Object(v.g)({userName:e}).then(function(a){var i=a.data.data;t.userModal.loading=!0,setTimeout(function(){t.userModal.loading=!1,t.userModal.dataList=i.filter(function(t){return t.label.toLowerCase().indexOf(e.toLowerCase())>-1})},200)}).catch(function(e){}):this.userModal.dataList=[]},transfer:function(e){this.userModal.visible=!0,this.userModal.value="",this.userModal.serviceNo=e.serviceNo},orderTransfer:function(){var e=this;(function(e){return Object(s.a)({url:"/order-service/service-transfer",method:"POST",data:e})})({serviceNo:this.userModal.serviceNo,opKey:this.status.name,toUserId:this.userModal.value,remark:this.userModal.remark}).then(function(t){t.data.code===e.$global.successCode&&(e.$message({message:"订单转交成功",type:"success"}),e.userModal.visible=!1,e.listOrder(e.getRequestParams()),e.$emit("order-service-detail",orderInfo))}).catch(function(e){})},collaboration:function(e){this.userModal.collaboration.visible=!0,this.userModal.collaboration.value="",this.userModal.collaboration.serviceNo=e.serviceNo},orderCollaboration:function(){var e=this;o({serviceNo:this.userModal.collaboration.serviceNo,toUserId:this.userModal.collaboration.value,opKey:this.status.name}).then(function(t){t.data.code===e.$global.successCode&&(e.$message({message:"邀请协协作人成功",type:"success"}),e.userModal.collaboration.visible=!1,e.$emit("order-service-detail",orderInfo))}).catch(function(e){})}},components:{pagination:c.a}},f={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"main-order-content"},[a("div",{staticClass:"order-common-table"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.table.loading,expression:"table.loading"}],staticStyle:{width:"100%"},attrs:{data:e.table.dataList,height:"100%"}},[a("el-table-column",{attrs:{type:"index",width:"43"}}),e._v(" "),a("el-table-column",{attrs:{width:"210",label:"服务订单号"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{staticClass:"text-click",on:{click:function(a){return e.showOrderDetail(t.row)}}},[e._v(e._s(t.row.serviceNo))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"userName",width:"80",label:"创建人"}}),e._v(" "),a("el-table-column",{attrs:{prop:"customerName",label:"客户名称","show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{prop:"contract",label:"联系人","show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{prop:"mobile",label:"手机","show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{label:"订单状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e.transOrderStatus(t.row.orderStatus)))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"订单日期",sortable:"","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e.formatTimeStamp(t.row.createTime)))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"订单金额","show-overflow-tooltip":"",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e.formatMoney(t.row.totalMoney)))])]}}])}),e._v(" "),0!==e.status.tabIndex&&"ORDER_COMPLETE"!==e.status.name?a("el-table-column",{attrs:{label:"操作",width:"130"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.showStart(t.row.cuUserId)?a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return e.showOrderDetailBatch(t.row)}}},[e._v(e._s(e.operation(e.status.label)))]):a("el-button",{attrs:{type:"text",disabled:"",size:"small"},on:{click:function(a){return e.showOrderDetailBatch(t.row)}}},[e._v(e._s(e.operation(e.status.label)))]),e._v(" "),e.showStart(t.row.cuUserId)&&1!==e.status.tabIndex?a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return e.transfer(t.row)}}},[e._v("转交")]):1!==e.status.tabIndex?a("el-button",{attrs:{type:"text",size:"small",disabled:""},on:{click:function(a){return e.transfer(t.row)}}},[e._v("转交")]):e._e(),e._v(" "),e.showStart(t.row.cuUserId)&&1!==e.status.tabIndex?a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return e.collaboration(t.row)}}},[e._v("邀请")]):1!==e.status.tabIndex?a("el-button",{attrs:{type:"text",size:"small",disabled:""},on:{click:function(a){return e.collaboration(t.row)}}},[e._v("邀请")]):e._e()]}}],null,!1,1675013426)}):e._e()],1)],1),e._v(" "),a("pagination",{attrs:{"page-object":e.pageObject},on:{pageChange:e.handleChange}}),e._v(" "),a("el-dialog",{staticClass:"custom-dialog",attrs:{title:"选择转交人",visible:e.userModal.visible},on:{"update:visible":function(t){return e.$set(e.userModal,"visible",t)}}},[a("el-form",[a("el-form-item",[a("el-select",{attrs:{filterable:"",remote:"","reserve-keyword":"",placeholder:"请输入姓名","remote-method":e.getUserLists},model:{value:e.userModal.value,callback:function(t){e.$set(e.userModal,"value",t)},expression:"userModal.value"}},e._l(e.userModal.dataList,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}},[a("span",{staticStyle:{float:"left"}},[e._v(e._s(t.label))]),e._v(" "),a("span",{staticStyle:{float:"right",color:"#8492a6","font-size":"13px","margin-left":"180px"}},[e._v(e._s(t.postName))]),e._v("  \n                        "),a("span",{staticStyle:{float:"right",color:"#8492a6","font-size":"13px"}},[e._v(e._s(t.mobile))])])}),1)],1),e._v(" "),a("el-form-item",[a("el-input",{attrs:{placeholder:"审批意见",type:"textarea",autosize:{minRows:4,maxRows:4}},model:{value:e.userModal.remark,callback:function(t){e.$set(e.userModal,"remark",t)},expression:"userModal.remark"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:e.orderTransfer}},[e._v("确 定")]),e._v(" "),a("el-button",{on:{click:function(t){e.userModal.visible=!1}}},[e._v("取 消")])],1)],1),e._v(" "),a("el-dialog",{staticClass:"custom-dialog",attrs:{title:"选择协作人",visible:e.userModal.collaboration.visible},on:{"update:visible":function(t){return e.$set(e.userModal.collaboration,"visible",t)}}},[a("el-form",[a("el-form-item",[a("el-select",{attrs:{filterable:"",remote:"","reserve-keyword":"",placeholder:"请输入姓名","remote-method":e.getUserLists},model:{value:e.userModal.collaboration.value,callback:function(t){e.$set(e.userModal.collaboration,"value",t)},expression:"userModal.collaboration.value"}},e._l(e.userModal.dataList,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:e.orderCollaboration}},[e._v("确 定")]),e._v(" "),a("el-button",{on:{click:function(t){e.userModal.collaboration.visible=!1}}},[e._v("取 消")])],1)],1)],1)},staticRenderFns:[]};var b=a("C7Lr")(p,f,!1,function(e){a("KqL0")},"data-v-0762f5d0",null).exports,h=a("39zi"),y=a("GObz"),_=a("VnLn"),g={props:["orderInfo","status"],data:function(){return{order:{serviceNo:"",orderNo:"",customerName:"",ospKey:"",orderType:null,contract:"",userName:"",totalMoney:"",contacts:"",mobile:"",orderTime:null,serverTime:null,openTime:null,remark:"",orderItems:[],installments:[]},installmentItem:{visible:!1,search:{keyword:""},insert:{visible:!1,width:"70px",form:{orderId:"",fund:"",money:null,status:"",remark:"",createTime:""}},update:{visible:!1,width:"70px",form:{orderId:"",fund:"",money:null,status:"",remark:"",createTime:""}}},process:"",itemActiveId:"fourth",title:"选择审批人",userModal:{visible:!1,dataList:[],value:"",remark:"",loading:!1,serviceNo:"",collaboration:{loading:!1,visible:!1,dataList:[],value:"",serviceNo:""}},barge:{visible:!1,remark:""},orderStep:{rejectedStep:"",crmOrderAuditProcess:[]},dynamic:{dynamicList:[],modal:{open:{visible:!1},insert:{visible:!1,labelWith:"80px",form:{dynamicId:"",serviceId:"",dynameicType:1,visitTime:"",planTime:"",visitway:[],visitContent:"",type:2}},update:{visible:!1,labelWith:"80px",form:{dynamicId:"",serviceId:"",dynameicType:1,visitTime:"",planTime:"",visitway:[],visitContent:"",type:2}}}},search:{visitwayList:[],app:{value:"",appList:[{label:"SAP-B1",value:"SAP-B1"},{label:"云MES",value:"云MES"},{label:"CRM",value:"CRM"}]}},members:{dataList:[]},activeId:"first",center:{lng:0,lat:0},zoom:3,position:{lng:0,lat:0},positionAadress:""}},computed:r()({},Object(d.c)(["serviceOrderStatus","loginUserInfo"]),{stepActive:function(){for(var e=0;e<this.serviceOrderStatus.length;e++){this.serviceOrderStatus[e].error="";var t=this.serviceOrderStatus[e];if(this.order.ospKey===t.key){for(var a=1;a<=e;a++)this.serviceOrderStatus[a].error="";return e===this.serviceOrderStatus.length-1?e+1:e}for(var i=0;i<this.serviceOrderStatus.length;i++){this.serviceOrderStatus[i].key===this.orderStep.rejectedStep&&(this.serviceOrderStatus[i].error="error")}}}}),mounted:function(){this.aaaa(),this.renderServiceOrderInfo(),this.getOrderServiceDynamicList(),this.getDynamicList()},methods:{showInserInstallment:function(e){return e===this.loginUserInfo.userId},deleteMember:function(e){var t=this;this.$confirm("是否确定删除该数据","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.$message({message:"暂未开通删除",type:"success"})}).catch(function(){})},getUserLists:function(e){var t=this;""!==e?Object(v.g)({userName:e}).then(function(a){var i=a.data.data;t.userModal.loading=!0,setTimeout(function(){t.userModal.loading=!1,t.userModal.dataList=i.filter(function(t){return t.label.toLowerCase().indexOf(e.toLowerCase())>-1})},200)}).catch(function(e){}):this.userModal.dataList=[]},collaboration:function(){this.userModal.collaboration.visible=!0,this.userModal.collaboration.value="",this.userModal.collaboration.serviceNo=this.order.serviceNo},orderCollaboration:function(){var e=this;o({serviceNo:this.userModal.collaboration.serviceNo,toUserId:this.userModal.collaboration.value,opKey:this.order.ospKey}).then(function(t){t.data.code===e.$global.successCode&&(e.$message({message:"邀请协协作人成功",type:"success"}),e.userModal.collaboration.visible=!1,e.getCooperationList())}).catch(function(e){})},showOStart:function(e){return"ORDER_WAIT_COMMIT"!==e},showOrderStart:function(e){return"ORDER_COMPLETE"!==e},showStart:function(e,t){return e===this.loginUserInfo.userId||"ORDER_WAIT_COMMIT"===t},timeStampToTime:function(e){return u()(e).format("YYYY-MM-DD HH:mm:ss")},timeStampToTimeDay:function(e){return u()(e).format("YYYY-MM-DD")},addDynamic:function(){var e=this;this.dynamic.modal.insert.form.serviceId=this.orderInfo.serviceId,this.dynamic.modal.insert.form.dynameicType=1,this.dynamic.modal.insert.form.planTime="",this.dynamic.modal.insert.form.visitTime="",this.dynamic.modal.insert.form.visitway=[],this.dynamic.modal.insert.form.visitContent="",this.dynamic.modal.insert.form.type=2,this.dynamic.modal.insert.visible=!0,this.$nextTick(function(){e.$refs.dynamicadd.resetFields()})},getOrderServiceDynamicList:function(){var e=this;Object(_.v)({serviceId:this.orderInfo.serviceId}).then(function(t){e.dynamic.dynamicList=t.data.data}).catch(function(e){})},addOrderServiceDynamicSubmit:function(){var e=this;this.$refs.dynamicadd.validate(function(t){if(!t)return e.$message.error("请输入正确的内容"),!1;Object(_.F)(e.dynamic.modal.insert.form).then(function(t){t.data.code===e.$global.successCode&&(e.$message({message:"添加成功",type:"success"}),e.dynamic.modal.insert.visible=!1,e.getOrderServiceDynamicList())}).catch(function(e){})})},updateDynamic:function(e){""===e.visitType||null===e.visitType?this.dynamic.modal.update.form.dynameicType=1:this.dynamic.modal.update.form.dynameicType=e.visitType,this.dynamic.modal.update.form.dynamicId=e.dynamicId,this.dynamic.modal.update.form.visitTime=e.visitTime,this.dynamic.modal.update.form.planTime=e.planTime,this.dynamic.modal.update.form.visitway=e.visitIdList,this.dynamic.modal.update.form.visitContent=e.visitContent,this.dynamic.modal.update.visible=!0},updateOrderServiceDynamicSubmit:function(){var e=this;Object(_.R)(this.dynamic.modal.update.form).then(function(t){t.data.code===e.$global.successCode&&(e.$message({message:"修改成功",type:"success"}),e.dynamic.modal.update.visible=!1,e.getOrderServiceDynamicList())}).catch(function(e){})},deleteOrderServiceDynamicSubmit:function(e){var t=this;this.$confirm("是否确定删除该动态","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(_.L)(e).then(function(e){e.data.code===t.$global.successCode&&(t.$message({message:"删除成功",type:"success"}),t.dynamic.modal.update.visible=!1,t.getOrderServiceDynamicList())}).catch(function(e){})}).catch(function(){})},aaaa:function(){var e,t=this;(e={serviceNo:this.orderInfo.serviceNo},Object(s.a)({url:"/order-service/service-rejected-order",method:"GET",params:e})).then(function(e){t.orderStep.rejectedStep=e.data.data.rejectedStep,t.orderStep.crmOrderAuditProcess=e.data.data.crmOrderAuditProcess}).catch(function(e){})},according:function(e){if(this.orderStep.crmOrderAuditProcess.length>=0){for(var t=[],a=0;a<this.orderStep.crmOrderAuditProcess.length;a++)t.push(this.orderStep.crmOrderAuditProcess[a].opKey);return t.indexOf(e)>=0}return!1},approver:function(){for(var e=this.orderInfo.orderStatus,t=this.status.items,a=0,i=0;a<t.length;a++)t[a].name===e&&(i=t[a].tabIndex);return this.status.items.length-(parseInt(i)+1)!=1||(this.title="审批意见",!1)},getRequestParams:function(){var e={serviceNo:this.orderInfo.serviceNo};return this.installmentItem.search.keyword&&(e.keyword=this.installmentItem.search.keyword),e},renderServiceOrderInfo:function(){var e,t=this;(e=this.getRequestParams(),Object(s.a)({url:"/order-service/service-info",method:"GET",params:e})).then(function(e){t.order=e.data.data,console.log(t.order);for(var a=0;a<t.status.items.length;a++)t.order.ospKey===t.status.items[a].name&&(t.process=t.status.items[a]);t.getCooperationList()}).catch(function(e){})},getCooperationList:function(){var e,t=this;(e={ospKey:this.order.ospKey,serviceId:this.order.serviceId},Object(s.a)({url:"/order-service/cooperation-list",method:"GET",params:e})).then(function(e){t.members.dataList=e.data.data}).catch(function(e){})},getAfterDiscountMoney:function(e){return e.standardContractMoney+e.userCountMoney+e.implMoney-e.discountMoney},getTotalMoney:function(){var e=0;return this.order.orderItems.forEach(function(t){e+=t.standardContractMoney+t.userCountMoney+t.implMoney-t.discountMoney}),Object(h.b)(e.toFixed(2))+"  "+Object(h.a)(e.toFixed(2))},formatTimeStamp:function(e){return u()(e).format("YYYY-MM-DD")},operation:function(){if(void 0!==this.process.label)return this.process.label.substring(1)},examinationApproval:function(){var e=this;this.userModal.visible=!0,Object(v.e)({opKey:this.process.name}).then(function(t){t.data.code===e.$global.successCode&&(e.userModal.dataList=t.data.data)}).catch(function(e){})},examinationApprovalSubmit:function(){var e,t=this,a=this.operation();if(this.approver()){if(""===this.userModal.value)return void this.$message({message:"请选择审批人",type:"warning"})}else this.userModal.value=this.order.cuUserId;(e={serviceNo:this.order.serviceNo,toUserId:this.userModal.value,opKey:this.process.name,remark:this.userModal.remark},Object(s.a)({url:"/order-service/service-approval-process",method:"POST",data:e})).then(function(e){e.data.code===t.$global.successCode&&(t.$message({message:"订单"+a+"成功",type:"success"}),t.userModal.visible=!1,t.$emit("close-service-detail-tab",t.order.orderNo))}).catch(function(e){})},orderBarge:function(){this.barge.visible=!0},orderBargeSubmit:function(){var e,t=this;(e={serviceNo:this.order.serviceNo,remark:this.barge.remark,opKey:this.process.name},Object(s.a)({url:"/order-service/service-rejected",method:"POST",data:e})).then(function(e){e.data.code===t.$global.successCode&&(t.$message({message:"订单驳回成功",type:"success"}),t.barge.visible=!1,t.$emit("close-service-detail-tab",t.order.orderNo))}).catch(function(e){})},installment:function(){this.installmentItem.visible=!0},getInstaStatus:function(e){return Object(y.c)(e)},calculateMoney:function(e){return e?Number(e):Number(0)},getMoneys:function(){var e=this,t=0;return this.order.installments.forEach(function(a){t+=e.calculateMoney(a.money)}),Object(h.b)(t.toFixed(2))+"  "+Object(h.a)(t.toFixed(2))},doSearch:function(){this.renderServiceOrderInfo()},addInstallment:function(){this.installmentItem.insert.visible=!0,this.installmentItem.insert.form.orderId=this.order.orderId,this.installmentItem.insert.form.fund="",this.installmentItem.insert.form.money=null,this.installmentItem.insert.form.status=0,this.installmentItem.insert.form.remark=""},insertInstallment:function(){this.installmentItem.insert.visible=!1,this.installmentItem.insert.form.status=2,this.addSubmitInstallment(this.installmentItem.insert.form)},insertSubmitInsertInstallmentIem:function(){this.installmentItem.insert.visible=!1,this.installmentItem.insert.form.status=0,this.addSubmitInstallment(this.installmentItem.insert.form)},addSubmitInstallment:function(e){var t=this;Object(l.j)(this.installmentItem.insert.form).then(function(e){e.data.code===t.$global.successCode&&(t.$message({message:"添加成功",type:"success"}),t.installmentItem.insert.visible=!1,t.renderServiceOrderInfo())}).catch(function(e){})},removeOrderInstallmentItem:function(e){var t=this;this.$confirm("是否确定移除该收款项","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(l.k)({coiId:e}).then(function(e){e.data.code===t.$global.successCode&&(t.$message({message:"删除成功",type:"success"}),t.renderServiceOrderInfo())}).catch(function(e){})}).catch(function(){})},editorOrderInstallmentItem:function(e){this.installmentItem.update.visible=!0,this.installmentItem.update.form.fund=e.fund,this.installmentItem.update.form.money=e.money,this.installmentItem.update.form.status=e.status,this.installmentItem.update.form.remark=e.remark,this.installmentItem.update.form.coiId=e.coiId},showEditor:function(e){return void 0===e.coiId||(void 0!==e.coiId&&2===e.status||void 0)},editorInsertInstallmentIem:function(){this.installmentItem.update.visible=!1,this.installmentItem.update.form.status=2,this.editorSubmitInstallment(this.installmentItem.update.form)},editorsubmitInsertInstallmentIem:function(){this.installmentItem.update.visible=!1,this.installmentItem.update.form.status=0,this.editorSubmitInstallment(this.installmentItem.update.form)},editorSubmitInstallment:function(e){var t=this;Object(l.i)(e).then(function(e){e.data.code===t.$global.successCode&&(t.$message({message:"修改成功",type:"success"}),t.installmentItem.insert.visible=!1,t.renderServiceOrderInfo())}).catch(function(e){})},commonurl3:function(e){return"static/3.png"},getDynamicList:function(){var e=this;Object(v.i)().then(function(t){e.search.visitwayList=t.data.data}).catch(function(e){})},updateServiceOrderOpentime:function(){var e,t=this;if(null===this.order.openTime)return this.$message({message:"请输入开通日期",type:"warning"}),!1;(e={serviceOrderId:this.order.serviceId,openTime:this.order.openTime},Object(s.a)({url:"/order-service/service-opentime",method:"POST",data:e})).then(function(e){e.data.code===t.$global.successCode&&(t.$message({message:"修改成功",type:"success"}),t.renderServiceOrderInfo(),console.log(t.order))}).catch(function(e){})},updateDynamicsss:function(e,t,a){this.center.lng=e,this.center.lat=t,this.zoom=15,this.position.lng=e,this.position.lat=t,this.positionAadress=a,this.dynamic.modal.open.visible=!0},updateDynamicssssss:function(){this.$message({message:"外访打卡不能删除",type:"warning"})},infoWindowClose:function(){this.show=!1},infoWindowOpen:function(){var e=this;setInterval(function(){e.show=!0},100)}}},w={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"sales-order order-detail-lin"},[a("div",{staticClass:"order-header"},[a("div",{staticClass:"order-header-img"},[a("img",{attrs:{src:e.commonurl3("订单"),alt:"image"}})]),e._v(" "),a("div",{staticClass:"order-header-content"},[a("div",{staticClass:"order-header-order-no"},[a("el-button",{attrs:{type:"text"}},[e._v("订单号:"+e._s(e.order.orderNo))])],1),e._v(" "),a("div",{staticClass:"order-header-font"},[a("div",{staticClass:"order-header-font1"},[e._v("合同编号")]),e._v(" "),a("div",{staticClass:"order-header-font2"},[e._v(e._s(e.order.contract))])]),e._v(" "),a("div",{staticClass:"order-header-font"},[a("div",{staticClass:"order-header-font1"},[e._v("客户名称")]),e._v(" "),a("div",{staticClass:"order-header-font2"},[e._v(e._s(e.order.customerName))])]),e._v(" "),a("div",{staticClass:"order-header-font"},[a("div",{staticClass:"order-header-font1"},[e._v("下单日期")]),e._v(" "),a("div",{staticClass:"order-header-font2"},[e._v(e._s(e.timeStampToTimeDay(e.order.orderTime)))])]),e._v(" "),e._m(0),e._v(" "),a("div",{staticClass:"order-header-font"},[a("div",{staticClass:"order-header-font1"},[e._v("所属销售")]),e._v(" "),a("div",{staticClass:"order-header-font2"},[e._v(e._s(e.order.userName))])])]),e._v(" "),a("div",{staticClass:"order-header-right"},[a("div",{staticClass:"order-header-button"},[e.showStart(e.order.cuUserId,e.order.ospKey)&&e.showOrderStart(e.order.ospKey)?a("div",[e.showOStart(e.order.ospKey)?a("el-button",{attrs:{type:"primary"},on:{click:e.orderBarge}},[e._v("驳回")]):e._e(),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.examinationApproval}},[e._v(e._s(e.operation()))]),e._v(" "),e.showOrderStart(e.order.ospKey)?a("el-button",{attrs:{type:"primary"},on:{click:e.updateServiceOrderOpentime}},[e._v("保存")]):e._e()],1):a("div",{staticStyle:{width:"20px",height:"30px"}})]),e._v(" "),a("div",{staticClass:"order-header-right-font"},[a("div",{staticClass:"order-header-font1"},[e._v("状态")]),e._v(" "),a("div",{staticClass:"order-header-font3"},[e._v(e._s(e.order.ospName))])]),e._v(" "),a("div",{staticClass:"order-header-right-font"},[a("div",{staticClass:"order-header-font1"},[e._v("订单金额")]),e._v(" "),a("div",{staticClass:"order-header-font3"},[e._v(e._s(e.order.totalMoney))])])])]),e._v(" "),a("div",{staticClass:"order-steps"},[a("div",{staticClass:"box-order-steps"},[a("el-steps",{attrs:{active:e.stepActive,"finish-status":"success","process-status":"finish","align-center":!0}},e._l(e.serviceOrderStatus,function(t){return a("el-step",{key:t.key,attrs:{status:t.error}},[a("template",{slot:"title"},[a("el-popover",{ref:t.key,refInFor:!0,attrs:{placement:"bottom",width:"200",trigger:"hover"}},[e.according(t.key)?a("div",e._l(e.orderStep.crmOrderAuditProcess,function(i){return t.key==i.opKey?a("div",{staticClass:"box-process"},[a("div",{staticClass:"box-img"},[a("img",{attrs:{src:i.userPhoto}})]),e._v(" "),a("div",{staticClass:"box-text1"},[a("span",[e._v(e._s(i.userName))])]),e._v(" "),a("div",{staticClass:"box-text1"},[a("span",[e._v(e._s(i.postName))])]),e._v(" "),a("div",{staticClass:"box-text2"},[a("span",{staticClass:"text"},[e._v("意见："+e._s(i.opinion))])])]):e._e()}),0):a("div",[e._v("暂无意见")])]),e._v(" "),a("el-button",{directives:[{name:"popover",rawName:"v-popover",value:t.key,expression:"status.key"}]},[e._v(e._s(t.name))])],1)],2)}),1)],1)]),e._v(" "),a("div",{staticClass:"sales-order-info",staticStyle:{width:"calc(100% - 30px)",background:"white",margin:"15px 15px 0 15px"}},[a("div",[a("el-row",{staticClass:"order-Detail"},[a("el-col",{staticClass:"order-Detail-col1 ",attrs:{span:16}},[a("div",{staticClass:"box-order-info box-order-info-detail"},[a("div",{staticClass:"box-order-menu"},[a("div",{staticClass:"box-order-info-title"},[e._v("订单信息")])]),e._v(" "),a("el-form",{attrs:{inline:!0,model:e.order}},[a("div",{staticClass:"box-item-row"},[a("el-form-item",{attrs:{label:"服务订单号："}},[a("el-input",{attrs:{readonly:!0},model:{value:e.order.serviceNo,callback:function(t){e.$set(e.order,"serviceNo",t)},expression:"order.serviceNo"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"订单号："}},[a("el-input",{attrs:{readonly:!0},model:{value:e.order.orderNo,callback:function(t){e.$set(e.order,"orderNo",t)},expression:"order.orderNo"}})],1)],1),e._v(" "),a("div",{staticClass:"box-item-row"},[a("el-form-item",{attrs:{label:"订单类型："}},[a("el-input",{attrs:{readonly:!0},model:{value:e.order.orderType,callback:function(t){e.$set(e.order,"orderType",t)},expression:"order.orderType"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"客户名称："}},[a("el-input",{attrs:{readonly:!0},model:{value:e.order.customerName,callback:function(t){e.$set(e.order,"customerName",t)},expression:"order.customerName"}})],1)],1),e._v(" "),a("div",{staticClass:"box-item-row"},[a("el-form-item",{attrs:{label:"所属销售："}},[a("el-input",{attrs:{readonly:!0},model:{value:e.order.userName,callback:function(t){e.$set(e.order,"userName",t)},expression:"order.userName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"订单金额："}},[a("el-input",{attrs:{readonly:!0},model:{value:e.order.totalMoney,callback:function(t){e.$set(e.order,"totalMoney",t)},expression:"order.totalMoney"}})],1)],1),e._v(" "),a("div",{staticClass:"box-item-row"},[a("el-form-item",{attrs:{label:"联系人："}},[a("el-input",{attrs:{readonly:!0},model:{value:e.order.contract,callback:function(t){e.$set(e.order,"contract",t)},expression:"order.contract"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"手机："}},[a("el-input",{attrs:{readonly:!0},model:{value:e.order.mobile,callback:function(t){e.$set(e.order,"mobile",t)},expression:"order.mobile"}})],1)],1),e._v(" "),a("div",{staticClass:"box-item-row"},[a("el-form-item",{attrs:{label:"订单日期："}},[a("el-date-picker",{attrs:{type:"datetime","value-format":"timestamp",readonly:!0},model:{value:e.order.orderTime,callback:function(t){e.$set(e.order,"orderTime",t)},expression:"order.orderTime"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"下单日期："}},[a("el-date-picker",{attrs:{type:"datetime","value-format":"timestamp",readonly:!0},model:{value:e.order.serverTime,callback:function(t){e.$set(e.order,"serverTime",t)},expression:"order.serverTime"}})],1)],1),e._v(" "),a("div",{staticClass:"box-item-row"},[a("el-form-item",{attrs:{label:"开通日期："}},[e.showOrderStart(e.order.ospKey)?a("el-date-picker",{attrs:{type:"datetime","value-format":"timestamp",placeholder:"请选择开通日期"},model:{value:e.order.openTime,callback:function(t){e.$set(e.order,"openTime",t)},expression:"order.openTime"}}):a("el-date-picker",{attrs:{type:"datetime","value-format":"timestamp",readonly:!0},model:{value:e.order.openTime,callback:function(t){e.$set(e.order,"openTime",t)},expression:"order.openTime"}})],1)],1),e._v(" "),a("div",{staticClass:"box-item-row"},[a("el-form-item",{staticClass:"box-item-textarea",attrs:{label:"备注："}},[a("el-input",{attrs:{readonly:!0},model:{value:e.order.remark,callback:function(t){e.$set(e.order,"remark",t)},expression:"order.remark"}})],1)],1)])],1),e._v(" "),a("div",{staticClass:"box-order-item-list"},[a("el-tabs",{staticClass:"detail-tabs",model:{value:e.itemActiveId,callback:function(t){e.itemActiveId=t},expression:"itemActiveId"}},[a("el-tab-pane",{attrs:{label:"订单明细",name:"fourth"}},[a("div",{staticStyle:{margin:"15px 15px 15px 15px"}},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.order.orderItems,height:"190"}},[a("el-table-column",{attrs:{type:"index",width:"50"}}),e._v(" "),a("el-table-column",{attrs:{prop:"productName",label:"产品",width:"130","show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{prop:"productVersion",label:"版本/PL",width:"130","show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{prop:"userCount",label:"平台用户数",width:"130","show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{prop:"deliveryPackage",label:"交付包",width:"130","show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{prop:"standardContractMoney",label:"合同标准金额",width:"130","show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{prop:"userCountMoney",label:"用户数总金额",width:"130","show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{prop:"implMoney",label:"实施费总金额",width:"130","show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{prop:"discountMoney",label:"优惠金额",width:"130","show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{label:"优惠后合同总金额",width:"150","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e.getAfterDiscountMoney(t.row)))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"开户日期",width:"120","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e.formatTimeStamp(t.row.openAccountTime)))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"到期日",width:"120","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e.formatTimeStamp(t.row.expireTime)))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"expire",label:"期限",width:"120","show-overflow-tooltip":""}}),e._v(" "),a("el-table-column")],1)],1)]),e._v(" "),a("el-tab-pane",{attrs:{label:"回款明细",name:"fifth"}},[a("div",{staticStyle:{margin:"15px 15px 15px 15px"}},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.order.installments,height:"190"}},[a("el-table-column",{attrs:{type:"index",width:"50"}}),e._v(" "),a("el-table-column",{attrs:{prop:"fund",label:"收款项",width:"150","show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{prop:"money",label:"收款金额",width:"180","show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{label:"收款时间",width:"150","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e.formatTimeStamp(t.row.createTime)))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"remark",label:"备注","show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{label:"审核状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{on:{click:function(a){return e.getInstaStatus(t.row)}}},[e._v(e._s(e.getInstaStatus(t.row).desc))])]}}])}),e._v(" "),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.showEditor(t.row)?a("el-button",{attrs:{icon:"el-icon-edit",type:"text",size:"small"},nativeOn:{click:function(a){return a.preventDefault(),e.editorOrderInstallmentItem(t.row)}}},[e._v("编辑")]):a("el-button",{attrs:{icon:"el-icon-edit",disabled:"",type:"text",size:"small"},nativeOn:{click:function(a){return a.preventDefault(),e.editorOrderInstallmentItem(t.row)}}},[e._v("编辑")]),e._v(" "),e.showEditor(t.row)?a("el-button",{attrs:{icon:"el-icon-close",type:"text",size:"small"},nativeOn:{click:function(a){return a.preventDefault(),e.removeOrderInstallmentItem(t.row.coiId)}}},[e._v("移除")]):a("el-button",{attrs:{icon:"el-icon-close",disabled:"",type:"text",size:"small"},nativeOn:{click:function(a){return a.preventDefault(),e.removeOrderInstallmentItem(t.row.coiId)}}},[e._v("移除")])]}}])})],1),e._v(" "),a("div",{staticClass:"order-table-total",staticStyle:{background:"white"}},[a("el-button",{attrs:{type:"text",size:"small",icon:"el-icon-plus"},on:{click:e.addInstallment}},[e._v("添加行")])],1),e._v(" "),a("div",{staticClass:"order-table-total"},[e._v("\n                                        合计："+e._s(e.getMoneys())+"\n                                    ")])],1)])],1)],1)]),e._v(" "),a("el-col",{staticClass:"order-Detail-col2",attrs:{span:8}},[a("div",{staticClass:"box-order-menu",staticStyle:{position:"relative","border-bottom":"0px"}},[a("el-tabs",{staticClass:"detail-tabs",staticStyle:{float:"left",width:"100%"},model:{value:e.activeId,callback:function(t){e.activeId=t},expression:"activeId"}},[a("el-tab-pane",{attrs:{label:"动态",name:"first"}},[a("div",{staticClass:"order-dynamic"},[a("div",{staticClass:"order-dynamic-top"},[a("div",{staticClass:"order-dynamic-top-1"}),e._v(" "),a("div",{staticClass:"order-dynamic-top-2"}),e._v(" "),a("div",{staticClass:"order-dynamic-top-3"},[a("el-button",{attrs:{type:"text"},on:{click:e.addDynamic}},[e._v("新增")])],1)]),e._v(" "),e._l(e.dynamic.dynamicList,function(t){return a("div",{staticClass:"height100"},[a("div",{staticClass:"dynamic-img"},[a("img",{attrs:{src:t.userPhoto,alt:"image"}})]),e._v(" "),a("el-tooltip",{attrs:{content:t.visitContent,placement:"bottom",effect:"light"}},[2===t.visitType?a("div",{staticClass:"dynamic-text"},[a("div",{staticClass:"dynamic-text-1"},[a("span",{staticClass:"dynamic-text-3"},[e._v(e._s(t.userName))]),e._v("  "+e._s(e.timeStampToTimeDay(t.visitTime)))]),e._v(" "),a("div",{staticClass:"dynamic-text-2"},[a("span",{staticClass:"dynamic-text-4"},[e._v("进行了外访打卡")]),e._v(" "),a("div",{staticStyle:{float:"right","margin-top":"-40px","margin-right":"10px"}},[a("a",{attrs:{href:"#"},on:{click:function(a){return e.updateDynamicsss(t.positionX,t.positionY,t.address)}}},[a("i",{staticClass:"el-icon-edit-outline",staticStyle:{color:"#0ae"},attrs:{"aria-hidden":"true"}})]),e._v(" \n                                                        "),a("a",{attrs:{href:"#"},on:{click:function(t){return e.updateDynamicssssss()}}},[a("i",{staticClass:"el-icon-close",staticStyle:{color:"#0ae"},attrs:{"aria-hidden":"true"}})])])])]):e._e(),e._v(" "),a("div",{staticClass:"dynamic-text"},[1===t.visitType?a("div",{staticClass:"dynamic-text-1"},[a("span",{staticClass:"dynamic-text-3"},[e._v(e._s(t.userName))]),e._v("  "+e._s(e.timeStampToTimeDay(t.planTime)))]):a("div",{staticClass:"dynamic-text-1"},[a("span",{staticClass:"dynamic-text-3"},[e._v(e._s(t.userName))]),e._v("  "+e._s(e.timeStampToTimeDay(t.visitTime)))]),e._v(" "),a("div",{staticClass:"dynamic-text-2"},[a("span",{staticClass:"dynamic-text-4"},[e._v("与客户进行了"+e._s(t.visitWay))]),e._v(" "),a("div",{staticStyle:{float:"right","margin-top":"-40px","margin-right":"10px"}},[a("a",{attrs:{href:"#"},on:{click:function(a){return e.updateDynamic(t)}}},[a("i",{staticClass:"el-icon-edit-outline",staticStyle:{color:"#0ae"},attrs:{"aria-hidden":"true"}})]),e._v(" \n                                                        "),a("a",{attrs:{href:"#"},on:{click:function(a){return e.deleteOrderServiceDynamicSubmit(t)}}},[a("i",{staticClass:"el-icon-close",staticStyle:{color:"#0ae"},attrs:{"aria-hidden":"true"}})])])])])])],1)})],2)]),e._v(" "),a("el-tab-pane",{attrs:{label:"协作",name:"second"}},[a("div",{staticClass:"box-members"},[a("ul",{staticClass:"members-item"},[e._l(e.members.dataList,function(t){return a("li",[a("img",{attrs:{src:t.userPhto}}),e._v(" "),a("span",{staticClass:"text1"},[e._v(e._s(t.username))]),e._v(" "),a("span",{staticClass:"text2"},[e._v(e._s(t.post))]),e._v(" "),a("div",{staticClass:"operations",on:{click:function(a){return e.deleteMember(t.userId)}}},[e._v("删除该协作人")])])}),e._v(" "),a("li",[a("div",{staticClass:"text3"},[a("i",{staticClass:"el-icon-plus"})]),e._v(" "),a("div",{staticClass:"operations",on:{click:e.collaboration}},[e._v("邀请协作人")])])],2)])])],1)],1)])],1)],1)]),e._v(" "),a("el-dialog",{staticClass:"custom-dialog",attrs:{title:e.title,visible:e.userModal.visible},on:{"update:visible":function(t){return e.$set(e.userModal,"visible",t)}}},[a("el-form",[e.approver()?a("el-form-item",[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.userModal.value,callback:function(t){e.$set(e.userModal,"value",t)},expression:"userModal.value"}},e._l(e.userModal.dataList,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1):e._e(),e._v(" "),"ORDER_WAIT_COMMIT"!==this.status.items[this.status.defaultTabIndex].name?a("el-form-item",[a("el-input",{attrs:{placeholder:"审批意见",type:"textarea",autosize:{minRows:4,maxRows:4}},model:{value:e.userModal.remark,callback:function(t){e.$set(e.userModal,"remark",t)},expression:"userModal.remark"}})],1):e._e()],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:e.examinationApprovalSubmit}},[e._v("确 定")]),e._v(" "),a("el-button",{on:{click:function(t){e.userModal.visible=!1}}},[e._v("取 消")])],1)],1),e._v(" "),a("el-dialog",{staticClass:"custom-dialog",attrs:{title:"驳回意见",visible:e.barge.visible},on:{"update:visible":function(t){return e.$set(e.barge,"visible",t)}}},[a("el-form",[a("el-form-item",[a("el-input",{attrs:{placeholder:"审批意见",type:"textarea",autosize:{minRows:4,maxRows:4}},model:{value:e.barge.remark,callback:function(t){e.$set(e.barge,"remark",t)},expression:"barge.remark"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:e.orderBargeSubmit}},[e._v("确 定")]),e._v(" "),a("el-button",{on:{click:function(t){e.barge.visible=!1}}},[e._v("取 消")])],1)],1),e._v(" "),a("el-dialog",{staticClass:"custom-dialog",attrs:{title:"添加动态",visible:e.dynamic.modal.insert.visible},on:{"update:visible":function(t){return e.$set(e.dynamic.modal.insert,"visible",t)}}},[a("el-form",{ref:"dynamicadd",attrs:{model:e.dynamic.modal.insert.form}},[a("el-form-item",{attrs:{label:"动态主题","label-width":e.dynamic.modal.insert.labelWith,prop:"dynameicType",rules:[{required:!0,message:"选择动态类型",trigger:"change"}]}},[a("el-radio-group",{model:{value:e.dynamic.modal.insert.form.dynameicType,callback:function(t){e.$set(e.dynamic.modal.insert.form,"dynameicType",t)},expression:"dynamic.modal.insert.form.dynameicType"}},[a("el-radio",{attrs:{size:"small",label:1}},[e._v("计划")]),e._v(" "),a("el-radio",{attrs:{size:"small",label:0}},[e._v("完成")])],1)],1),e._v(" "),1===e.dynamic.modal.insert.form.dynameicType?a("el-form-item",{attrs:{label:"计划时间","label-width":e.dynamic.modal.insert.labelWith,prop:"planTime",rules:[{required:!0,message:"请输入计划时间",trigger:"change"}]}},[a("el-date-picker",{attrs:{type:"datetime",placeholder:"选择日期时间"},model:{value:e.dynamic.modal.insert.form.planTime,callback:function(t){e.$set(e.dynamic.modal.insert.form,"planTime",t)},expression:"dynamic.modal.insert.form.planTime"}})],1):a("el-form-item",{attrs:{label:"完成时间","label-width":e.dynamic.modal.insert.labelWith,prop:"visitTime",rules:[{required:!0,message:"请输入完成时间",trigger:"change"}]}},[a("el-date-picker",{attrs:{type:"datetime",placeholder:"选择日期时间"},model:{value:e.dynamic.modal.insert.form.visitTime,callback:function(t){e.$set(e.dynamic.modal.insert.form,"visitTime",t)},expression:"dynamic.modal.insert.form.visitTime"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"动态类型","label-width":e.dynamic.modal.insert.labelWith,prop:"visitway",rules:[{required:!0,message:"选择动态类型",trigger:"change"}]}},[a("el-cascader",{attrs:{options:e.search.visitwayList,"change-on-select":"",placeholder:"请选择"},model:{value:e.dynamic.modal.insert.form.visitway,callback:function(t){e.$set(e.dynamic.modal.insert.form,"visitway",t)},expression:"dynamic.modal.insert.form.visitway"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"内容","label-width":e.dynamic.modal.insert.labelWith,prop:"visitContent",rules:[{required:!0,message:"请输入内容",trigger:"change"}]}},[a("el-input",{attrs:{type:"textarea",rows:6},model:{value:e.dynamic.modal.insert.form.visitContent,callback:function(t){e.$set(e.dynamic.modal.insert.form,"visitContent",t)},expression:"dynamic.modal.insert.form.visitContent"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:e.addOrderServiceDynamicSubmit}},[e._v("确 定")]),e._v(" "),a("el-button",{on:{click:function(t){e.dynamic.modal.insert.visible=!1}}},[e._v("取 消")])],1)],1),e._v(" "),a("el-dialog",{staticClass:"custom-dialog",attrs:{title:"修改动态",visible:e.dynamic.modal.update.visible},on:{"update:visible":function(t){return e.$set(e.dynamic.modal.update,"visible",t)}}},[a("el-form",{attrs:{model:e.dynamic.modal.update.form}},[a("el-form-item",{attrs:{label:"动态主题","label-width":e.dynamic.modal.insert.labelWith}},[a("el-radio-group",{model:{value:e.dynamic.modal.update.form.dynameicType,callback:function(t){e.$set(e.dynamic.modal.update.form,"dynameicType",t)},expression:"dynamic.modal.update.form.dynameicType"}},[a("el-radio",{attrs:{size:"small",label:1}},[e._v("计划")]),e._v(" "),a("el-radio",{attrs:{size:"small",label:0}},[e._v("完成")])],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"计划时间","label-width":e.dynamic.modal.update.labelWith}},[1===e.dynamic.modal.update.form.dynameicType?a("el-date-picker",{attrs:{type:"datetime",placeholder:"选择日期时间"},model:{value:e.dynamic.modal.update.form.planTime,callback:function(t){e.$set(e.dynamic.modal.update.form,"planTime",t)},expression:"dynamic.modal.update.form.planTime"}}):a("el-date-picker",{attrs:{disabled:"",type:"datetime",placeholder:"选择日期时间"},model:{value:e.dynamic.modal.update.form.planTime,callback:function(t){e.$set(e.dynamic.modal.update.form,"planTime",t)},expression:"dynamic.modal.update.form.planTime"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"完成时间","label-width":e.dynamic.modal.update.labelWith}},[2===e.dynamic.modal.update.form.dynameicType?a("el-date-picker",{attrs:{type:"datetime",placeholder:"选择日期时间"},model:{value:e.dynamic.modal.update.form.visitTime,callback:function(t){e.$set(e.dynamic.modal.update.form,"visitTime",t)},expression:"dynamic.modal.update.form.visitTime"}}):a("el-date-picker",{attrs:{disabled:"",type:"datetime",placeholder:"选择日期时间"},model:{value:e.dynamic.modal.update.form.visitTime,callback:function(t){e.$set(e.dynamic.modal.update.form,"visitTime",t)},expression:"dynamic.modal.update.form.visitTime"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"动态类型","label-width":e.dynamic.modal.update.labelWith}},[a("el-cascader",{attrs:{options:e.search.visitwayList,"change-on-select":"",placeholder:"请选择"},model:{value:e.dynamic.modal.update.form.visitway,callback:function(t){e.$set(e.dynamic.modal.update.form,"visitway",t)},expression:"dynamic.modal.update.form.visitway"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"内容","label-width":e.dynamic.modal.update.labelWith}},[a("el-input",{attrs:{type:"textarea",rows:6},model:{value:e.dynamic.modal.update.form.visitContent,callback:function(t){e.$set(e.dynamic.modal.update.form,"visitContent",t)},expression:"dynamic.modal.update.form.visitContent"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:e.updateOrderServiceDynamicSubmit}},[e._v("确 定")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.dynamic.modal.update.visible=!1}}},[e._v("删 除")])],1)],1),e._v(" "),a("el-dialog",{staticClass:"custom-dialog",attrs:{title:"动态打卡",visible:e.dynamic.modal.open.visible},on:{"update:visible":function(t){return e.$set(e.dynamic.modal.open,"visible",t)}}},[a("baidu-map",{staticClass:"map",attrs:{center:e.center,zoom:e.zoom,"scroll-wheel-zoom":!0}},[a("bm-marker",{attrs:{position:e.position,dragging:!0,"auto-viewport":!0,animation:"BMAP_ANIMATION_BOUNCE"}},[a("bm-info-window",{staticStyle:{"font-size":"14px"},attrs:{show:!0},on:{close:e.infoWindowClose,open:e.infoWindowOpen}},[a("p",[e._v("打卡地址："+e._s(e.positionAadress))])])],1)],1)],1),e._v(" "),a("el-dialog",{staticClass:"custom-dialog",attrs:{title:"选择协作人",visible:e.userModal.collaboration.visible},on:{"update:visible":function(t){return e.$set(e.userModal.collaboration,"visible",t)}}},[a("el-form",[a("el-form-item",[a("el-select",{attrs:{filterable:"",remote:"","reserve-keyword":"",placeholder:"请输入姓名","remote-method":e.getUserLists},model:{value:e.userModal.collaboration.value,callback:function(t){e.$set(e.userModal.collaboration,"value",t)},expression:"userModal.collaboration.value"}},e._l(e.userModal.dataList,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:e.orderCollaboration}},[e._v("确 定")]),e._v(" "),a("el-button",{on:{click:function(t){e.userModal.collaboration.visible=!1}}},[e._v("取 消")])],1)],1),e._v(" "),a("div",{staticStyle:{height:"15px"}}),e._v(" "),a("el-dialog",{staticClass:"custom-dialog dialog-double-line table-dialog",attrs:{title:"付款",visible:e.installmentItem.visible},on:{"update:visible":function(t){return e.$set(e.installmentItem,"visible",t)}}},[a("div",{staticClass:"order-search",staticStyle:{width:"630px",float:"left","margin-top":"-5px"}},[a("el-input",{staticClass:"input-with-select",attrs:{placeholder:"请输入内容","suffix-icon":"el-icon-search"},nativeOn:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.doSearch(t)}},model:{value:e.installmentItem.search.keyword,callback:function(t){e.$set(e.installmentItem.search,"keyword",t)},expression:"installmentItem.search.keyword"}})],1),e._v(" "),a("el-button",{staticStyle:{"margin-bottom":"15px","margin-top":"-5px",float:"right"},attrs:{type:"primary"},on:{click:e.addInstallment}},[e._v("添加收款项")]),e._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.order.installments,height:"500"}},[a("el-table-column",{attrs:{type:"index",width:"50"}}),e._v(" "),a("el-table-column",{attrs:{prop:"fund",label:"收款项",width:"150","show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{prop:"money",label:"收款金额",width:"180","show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{label:"收款时间",width:"150","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e.formatTimeStamp(t.row.createTime)))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"remark",label:"备注","show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{label:"审核状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{on:{click:function(a){return e.getInstaStatus(t.row)}}},[e._v(e._s(e.getInstaStatus(t.row).desc))])]}}])}),e._v(" "),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.showEditor(t.row)?a("el-button",{attrs:{type:"text",size:"small"},nativeOn:{click:function(a){return a.preventDefault(),e.editorOrderInstallmentItem(t.row)}}},[e._v("编辑")]):a("el-button",{attrs:{disabled:"",type:"text",size:"small"},nativeOn:{click:function(a){return a.preventDefault(),e.editorOrderInstallmentItem(t.row)}}},[e._v("编辑")]),e._v(" "),e.showEditor(t.row)?a("el-button",{attrs:{type:"text",size:"small"},nativeOn:{click:function(a){return a.preventDefault(),e.removeOrderInstallmentItem(t.$index,t.row.coiId)}}},[e._v("移除")]):a("el-button",{attrs:{disabled:"",type:"text",size:"small"},nativeOn:{click:function(a){return a.preventDefault(),e.removeOrderInstallmentItem(t.$index,t.row.coiId)}}},[e._v("移除")])]}}])})],1),e._v(" "),a("div",{staticClass:"order-table-total"},[e._v("\n            合计："+e._s(e.getMoneys())+"\n        ")])],1),e._v(" "),a("el-dialog",{staticClass:"custom-dialog",attrs:{title:"添加收款项",visible:e.installmentItem.insert.visible},on:{"update:visible":function(t){return e.$set(e.installmentItem.insert,"visible",t)}}},[a("el-form",{attrs:{model:e.installmentItem.insert.form}},[a("el-form-item",{attrs:{label:"收款项","label-width":e.installmentItem.insert.width,prop:"userCount"}},[a("el-input",{attrs:{placeholder:"请输入收款项"},model:{value:e.installmentItem.insert.form.fund,callback:function(t){e.$set(e.installmentItem.insert.form,"fund",t)},expression:"installmentItem.insert.form.fund"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"收款金额","label-width":e.installmentItem.insert.width,prop:"userCount"}},[a("el-input",{attrs:{type:"number",placeholder:"请输入收款金额"},model:{value:e.installmentItem.insert.form.money,callback:function(t){e.$set(e.installmentItem.insert.form,"money",t)},expression:"installmentItem.insert.form.money"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"备注","label-width":e.installmentItem.insert.width}},[a("el-input",{attrs:{type:"textarea",rows:6},model:{value:e.installmentItem.insert.form.remark,callback:function(t){e.$set(e.installmentItem.insert.form,"remark",t)},expression:"installmentItem.insert.form.remark"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:e.insertInstallment}},[e._v("确 定")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.insertSubmitInsertInstallmentIem}},[e._v("提 交")])],1)],1),e._v(" "),a("el-dialog",{staticClass:"custom-dialog",attrs:{title:"编辑收款项",visible:e.installmentItem.update.visible},on:{"update:visible":function(t){return e.$set(e.installmentItem.update,"visible",t)}}},[a("el-form",{attrs:{model:e.installmentItem.update.form}},[a("el-form-item",{attrs:{label:"收款项","label-width":e.installmentItem.update.width,prop:"userCount"}},[a("el-input",{attrs:{placeholder:"请输入收款项"},model:{value:e.installmentItem.update.form.fund,callback:function(t){e.$set(e.installmentItem.update.form,"fund",t)},expression:"installmentItem.update.form.fund"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"收款金额","label-width":e.installmentItem.update.width,prop:"userCount"}},[a("el-input",{attrs:{type:"number",placeholder:"请输入收款金额"},model:{value:e.installmentItem.update.form.money,callback:function(t){e.$set(e.installmentItem.update.form,"money",t)},expression:"installmentItem.update.form.money"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"备注","label-width":e.installmentItem.update.width}},[a("el-input",{attrs:{type:"textarea",rows:6},model:{value:e.installmentItem.update.form.remark,callback:function(t){e.$set(e.installmentItem.update.form,"remark",t)},expression:"installmentItem.update.form.remark"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:e.editorInsertInstallmentIem}},[e._v("保 存")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.editorsubmitInsertInstallmentIem}},[e._v("提 交")])],1)],1)],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"order-header-font"},[t("div",{staticClass:"order-header-font1"},[this._v("订单类型")]),this._v(" "),t("div",{staticClass:"order-header-font2"},[this._v("新订单")])])}]};var I=a("C7Lr")(g,w,!1,function(e){a("q/kj"),a("Z7E/")},"data-v-6b7212c2",null).exports,k={data:function(){return{customerInfo:null,tabs:{active:"1",items:[]},itemTabs:{defaultTabIndex:0,active:this.$global.orderAllTab,items:[{tabIndex:0,name:this.$global.orderAllTab,label:"所有订单"}]},search:{keyword:""},radio:"",orderService:{visible:!1,loading:!1,orderId:"",keyword:"",orderList:[]},pageObject:{page:this.$global.pageParam.page,size:this.$global.pageParam.size,total:this.$global.pageParam.total}}},computed:r()({},Object(d.c)(["serviceOrderStatus"]),{breadcrumb:function(){var e=[{index:1,title:"首页"},{index:2,title:"订单管理"},{index:3,title:"服务订单"}];return"1"===this.tabs.active?e.push({index:4,title:"订单列表"}):"insert-sales-order"===this.tabs.active?e.push({index:4,title:"新增订单"}):e.push({index:4,title:"订单详情"}),e}}),mounted:function(){this.salesOrderAuditProccess()},methods:r()({},Object(d.b)(["setServiceOrderStatus","setOrderStatusUser"]),{salesOrderAuditProccess:function(){var e=this;Object(s.a)({url:"/order-service/service-status",method:"GET"}).then(function(t){var a=[];t.data.data.forEach(function(t,i){e.itemTabs.items.push({tabIndex:i+1,name:t.ospKey,label:t.ospName}),a.push({key:t.ospKey,name:t.ospName})}),e.setServiceOrderStatus(a)}).catch(function(e){})},changeComponent:function(e){this.itemTabs.defaultTabIndex=e.index,console.log(this.itemTabs.defaultTabIndex),this.search.keyword="",this.doSearch()},doSearch:function(){this.$refs.childTabs[this.itemTabs.defaultTabIndex].doSearch(this.search.keyword)},addMainCardTabs:function(e,t){var a=this.tabs.items;if(a.length>=7)this.$message({message:"请关闭多余的标签页",type:"warning"});else{for(var i=!0,r=e.orderNo,s=0;s<a.length;s++){if(a[s].name===r){i=!1;break}}i&&this.tabs.items.push({title:"订单详情",name:r,orderInfo:e,status:t}),this.tabs.active=r}},removeMainCardTabs:function(e){if("1"!==e){var t=this.tabs.items,a=this.tabs.active;this.tabs.active===e&&(t.forEach(function(i,r){if(i.name===e){var s=t[r+1]||t[r-1];s&&(a=s.name)}}),this.tabs.active=a),this.tabs.items=t.filter(function(t){return t.name!==e}),0===this.tabs.items.length&&(this.tabs.active="1")}else this.$message({message:"该标签不能被关闭",type:"warning"})},showOrderDetail:function(e){this.addMainCardTabs(e,this.itemTabs)},closeServiceDetailOrderTab:function(e){this.removeMainCardTabs(e),this.$refs.childTabs[this.itemTabs.defaultTabIndex].doSearch("")},addOrderService:function(){this.radio="",this.orderService.visible=!0,this.orderService.orderId="",this.getOrderList()},getOrderListLine:function(){this.pageObject.page=1,this.getOrderList()},getOrderList:function(){var e=this;Object(l.d)(this.getOrderParams()).then(function(t){var a=t.data.data;e.orderService.loading=!0,e.orderService.loading=!1,e.pageObject.total=a.total,e.orderService.orderList=a.list}).catch(function(e){})},handleChange:function(){this.getOrderList()},getTemplateRow:function(e,t){this.orderService.orderId=t.orderId},getOrderParams:function(){var e={page:this.pageObject.page,size:this.pageObject.size};return this.orderService.keyword&&(e.keyword=this.orderService.keyword),e},addOrderServiceSubmit:function(){var e,t=this;""!==this.orderService.orderId?(e={orderId:this.orderService.orderId},Object(s.a)({url:"/order-service/add-service",method:"POST",data:e})).then(function(e){e.data.code===t.$global.successCode&&(t.$message({message:"创建服务订单成功",type:"success"}),t.orderService.visible=!1,t.$refs.childTabs[t.itemTabs.defaultTabIndex].doSearch(""))}).catch(function(e){}):this.$message({message:"请选择订单",type:"warning"})}}),components:{breadcrumb:n.a,"order-service-list":b,"order-service-detail":I,pagination:c.a}},x={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"main-content order-List"},[a("breadcrumb",{attrs:{items:e.breadcrumb}}),e._v(" "),a("div",{staticClass:"tabs-box"},["1"==e.tabs.active?a("div",{staticClass:"order-button-search"},[a("el-button",{attrs:{type:"primary"},on:{click:e.addOrderService}},[e._v("新建服务订单")]),e._v(" "),a("div",{staticClass:"order-search"},[a("el-input",{staticClass:"input-with-select",attrs:{placeholder:"请输入内容","suffix-icon":"el-icon-search"},nativeOn:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.doSearch(t)}},model:{value:e.search.keyword,callback:function(t){e.$set(e.search,"keyword",t)},expression:"search.keyword"}})],1)],1):e._e(),e._v(" "),a("el-tabs",{staticClass:"main-card-tabs",attrs:{type:"card",closable:""},on:{"tab-remove":e.removeMainCardTabs},model:{value:e.tabs.active,callback:function(t){e.$set(e.tabs,"active",t)},expression:"tabs.active"}},[a("el-tab-pane",{attrs:{label:"服务订单",name:"1"}},[a("el-tabs",{staticClass:"order-tabs",on:{"tab-click":e.changeComponent},model:{value:e.itemTabs.active,callback:function(t){e.$set(e.itemTabs,"active",t)},expression:"itemTabs.active"}},e._l(e.itemTabs.items,function(t){return a("el-tab-pane",{key:t.name,attrs:{label:t.label,name:t.name}},[a("order-service-list",{ref:"childTabs",refInFor:!0,attrs:{status:t},on:{"order-service-detail":e.showOrderDetail}})],1)}),1)],1),e._v(" "),e._l(e.tabs.items,function(t){return a("el-tab-pane",{key:t.name,attrs:{label:t.title,name:t.name}},[t.orderInfo?a("order-service-detail",{attrs:{status:t.status,"order-info":t.orderInfo},on:{"close-service-detail-tab":e.closeServiceDetailOrderTab}}):e._e()],1)})],2)],1),e._v(" "),a("el-dialog",{staticClass:"custom-dialog dialog-double-line table-dialog",attrs:{title:"新建服务订单",visible:e.orderService.visible},on:{"update:visible":function(t){return e.$set(e.orderService,"visible",t)}}},[a("div",{staticStyle:{width:"760px","margin-top":"-5px","padding-bottom":"5px"}},[a("el-input",{attrs:{placeholder:"请输入内容","suffix-icon":"el-icon-search"},nativeOn:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getOrderListLine(t)}},model:{value:e.orderService.keyword,callback:function(t){e.$set(e.orderService,"keyword",t)},expression:"orderService.keyword"}})],1),e._v(" "),a("div",{staticClass:"common-table common-table-line"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.orderService.orderList,height:"100%"},nativeOn:{keydown:function(t){if(!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null}}},[a("el-table-column",{attrs:{type:"index",width:"50"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-radio",{attrs:{label:t.row.orderId},nativeOn:{change:function(a){return e.getTemplateRow(t.$index,t.row)}},model:{value:e.radio,callback:function(t){e.radio=t},expression:"radio"}},[e._v(" ")])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"orderNo",width:"240",label:"订单编号","show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{prop:"customerName",label:"公司名称","show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{prop:"contacts",label:"联系人","show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{prop:"mobile",label:"手机号","show-overflow-tooltip":""}})],1)],1),e._v(" "),a("pagination",{attrs:{"page-object":e.pageObject},on:{pageChange:e.handleChange}}),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:e.addOrderServiceSubmit}},[e._v("确 定")]),e._v(" "),a("el-button",{on:{click:function(t){e.orderService.visible=!1}}},[e._v("取 消")])],1)],1)],1)},staticRenderFns:[]};var C=a("C7Lr")(k,x,!1,function(e){a("olWg"),a("Vz2w")},"data-v-240f6d26",null);t.default=C.exports},Vz2w:function(e,t){},"Z7E/":function(e,t){},olWg:function(e,t){},"q/kj":function(e,t){}});